INFO:root:Namespace(model_name='BSARec')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 14:12:53 ---------------------------------------------
INFO:root:
=============================================
 Arguments                    | Values       
=============================================
 alpha                        | 0.7         
 attention_probs_dropout_prob | 0.1         
 batch_size                   | 256         
 c                            | 5           
 dataset                      | MovieLens_1M
 dropout                      | 0           
 early_stop                   | 10          
 emb_size                     | 64          
 epoch                        | 200         
 eval_batch_size              | 256         
 gpu                          | 0           
 hidden_dropout_prob          | 0.1         
 hidden_size                  | 64          
 history_max                  | 50          
 l2                           | 1e-06       
 lr                           | 0.0001      
 num_heads                    | 4           
 num_layers                   | 2           
 num_neg                      | 1           
 num_workers                  | 0           
 optimizer                    | Adam        
 random_seed                  | 0           
 test_all                     | 0           
 topk                         | 5,10,20,50  
=============================================
INFO:root:Device: cuda
INFO:root:Load corpus from ../data/MovieLens_1M/SeqReader.pkl
INFO:root:#params: 303680
INFO:root:BSARec(
  (i_embeddings): Embedding(3126, 64)
  (p_embeddings): Embedding(51, 64)
  (transformer_block): ModuleList(
    (0): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.3942 [61.2 s]    dev=(HR@5:0.3411,NDCG@5:0.2282) [0.1 s] *
INFO:root:Epoch 2     loss=0.3002 [58.9 s]    dev=(HR@5:0.3794,NDCG@5:0.2499) [0.1 s] *
INFO:root:Epoch 3     loss=0.2538 [58.9 s]    dev=(HR@5:0.3938,NDCG@5:0.2629) [0.1 s] *
INFO:root:Epoch 4     loss=0.2255 [59.8 s]    dev=(HR@5:0.4192,NDCG@5:0.2821) [0.1 s] *
INFO:root:Epoch 5     loss=0.1993 [58.3 s]    dev=(HR@5:0.4485,NDCG@5:0.3090) [0.1 s] *
INFO:root:Epoch 6     loss=0.1771 [59.5 s]    dev=(HR@5:0.4633,NDCG@5:0.3231) [0.1 s] *
INFO:root:Epoch 7     loss=0.1628 [60.1 s]    dev=(HR@5:0.4692,NDCG@5:0.3314) [0.1 s] *
INFO:root:Epoch 8     loss=0.1509 [57.8 s]    dev=(HR@5:0.4762,NDCG@5:0.3333) [0.1 s] *
INFO:root:Epoch 9     loss=0.1413 [59.4 s]    dev=(HR@5:0.4832,NDCG@5:0.3434) [0.1 s] *
INFO:root:Epoch 10    loss=0.1342 [58.4 s]    dev=(HR@5:0.5031,NDCG@5:0.3550) [0.1 s] *
INFO:root:Epoch 11    loss=0.1290 [58.8 s]    dev=(HR@5:0.5066,NDCG@5:0.3602) [0.1 s] *
INFO:root:Epoch 12    loss=0.1240 [59.2 s]    dev=(HR@5:0.5141,NDCG@5:0.3662) [0.1 s] *
INFO:root:Epoch 13    loss=0.1195 [58.2 s]    dev=(HR@5:0.5148,NDCG@5:0.3686) [0.1 s] *
INFO:root:Epoch 14    loss=0.1153 [58.2 s]    dev=(HR@5:0.5195,NDCG@5:0.3734) [0.1 s] *
INFO:root:Epoch 15    loss=0.1123 [59.8 s]    dev=(HR@5:0.5246,NDCG@5:0.3730) [0.1 s]
INFO:root:Epoch 16    loss=0.1087 [60.0 s]    dev=(HR@5:0.5375,NDCG@5:0.3823) [0.1 s] *
INFO:root:Epoch 17    loss=0.1060 [58.5 s]    dev=(HR@5:0.5254,NDCG@5:0.3774) [0.1 s]
INFO:root:Epoch 18    loss=0.1035 [57.7 s]    dev=(HR@5:0.5390,NDCG@5:0.3849) [0.1 s] *
INFO:root:Epoch 19    loss=0.1008 [59.7 s]    dev=(HR@5:0.5351,NDCG@5:0.3820) [0.1 s]
INFO:root:Epoch 20    loss=0.0996 [58.7 s]    dev=(HR@5:0.5324,NDCG@5:0.3829) [0.1 s]
INFO:root:Epoch 21    loss=0.0978 [57.7 s]    dev=(HR@5:0.5281,NDCG@5:0.3832) [0.1 s]
INFO:root:Epoch 22    loss=0.0957 [65.4 s]    dev=(HR@5:0.5316,NDCG@5:0.3873) [0.1 s] *
INFO:root:Epoch 23    loss=0.0941 [57.9 s]    dev=(HR@5:0.5324,NDCG@5:0.3850) [0.1 s]
INFO:root:Epoch 24    loss=0.0922 [59.6 s]    dev=(HR@5:0.5355,NDCG@5:0.3870) [0.1 s]
INFO:root:Epoch 25    loss=0.0908 [68.1 s]    dev=(HR@5:0.5375,NDCG@5:0.3851) [0.1 s]
INFO:root:Epoch 26    loss=0.0897 [62.8 s]    dev=(HR@5:0.5433,NDCG@5:0.3864) [0.1 s]
INFO:root:Epoch 27    loss=0.0883 [60.2 s]    dev=(HR@5:0.5402,NDCG@5:0.3893) [0.1 s] *
INFO:root:Epoch 28    loss=0.0877 [67.2 s]    dev=(HR@5:0.5445,NDCG@5:0.3920) [0.1 s] *
INFO:root:Epoch 29    loss=0.0866 [58.4 s]    dev=(HR@5:0.5402,NDCG@5:0.3867) [0.1 s]
INFO:root:Epoch 30    loss=0.0860 [59.7 s]    dev=(HR@5:0.5433,NDCG@5:0.3924) [0.1 s] *
INFO:root:Epoch 31    loss=0.0848 [60.7 s]    dev=(HR@5:0.5402,NDCG@5:0.3873) [0.1 s]
INFO:root:Epoch 32    loss=0.0835 [64.1 s]    dev=(HR@5:0.5371,NDCG@5:0.3870) [0.1 s]
INFO:root:Epoch 33    loss=0.0819 [59.6 s]    dev=(HR@5:0.5340,NDCG@5:0.3823) [0.1 s]
INFO:root:Epoch 34    loss=0.0814 [62.9 s]    dev=(HR@5:0.5371,NDCG@5:0.3874) [0.1 s]
INFO:root:Epoch 35    loss=0.0819 [59.3 s]    dev=(HR@5:0.5418,NDCG@5:0.3890) [0.1 s]
INFO:root:Epoch 36    loss=0.0791 [59.6 s]    dev=(HR@5:0.5398,NDCG@5:0.3906) [0.1 s]
INFO:root:Epoch 37    loss=0.0799 [58.8 s]    dev=(HR@5:0.5383,NDCG@5:0.3888) [0.1 s]
INFO:root:Epoch 38    loss=0.0792 [58.3 s]    dev=(HR@5:0.5441,NDCG@5:0.3887) [0.1 s]
INFO:root:Epoch 39    loss=0.0783 [63.7 s]    dev=(HR@5:0.5398,NDCG@5:0.3890) [0.1 s]
INFO:root:Epoch 40    loss=0.0778 [60.7 s]    dev=(HR@5:0.5425,NDCG@5:0.3879) [0.1 s]
INFO:root:Epoch 41    loss=0.0765 [60.0 s]    dev=(HR@5:0.5386,NDCG@5:0.3879) [0.1 s]
INFO:root:Epoch 42    loss=0.0768 [61.0 s]    dev=(HR@5:0.5425,NDCG@5:0.3911) [0.1 s]
INFO:root:Epoch 43    loss=0.0757 [60.4 s]    dev=(HR@5:0.5437,NDCG@5:0.3917) [0.1 s]
INFO:root:Epoch 44    loss=0.0759 [61.3 s]    dev=(HR@5:0.5410,NDCG@5:0.3885) [0.1 s]
INFO:root:Epoch 45    loss=0.0747 [64.0 s]    dev=(HR@5:0.5386,NDCG@5:0.3901) [0.1 s]
INFO:root:Epoch 46    loss=0.0744 [59.8 s]    dev=(HR@5:0.5297,NDCG@5:0.3844) [0.1 s]
INFO:root:Epoch 47    loss=0.0741 [58.2 s]    dev=(HR@5:0.5328,NDCG@5:0.3852) [0.1 s]
INFO:root:Epoch 48    loss=0.0730 [57.7 s]    dev=(HR@5:0.5336,NDCG@5:0.3831) [0.1 s]
INFO:root:Epoch 49    loss=0.0738 [58.3 s]    dev=(HR@5:0.5340,NDCG@5:0.3859) [0.1 s]
INFO:root:Epoch 50    loss=0.0734 [58.6 s]    dev=(HR@5:0.5293,NDCG@5:0.3841) [0.1 s]
INFO:root:Early stop at 50 based on dev result.
INFO:root:
Best Iter(dev)=   30	 dev=(HR@5:0.5433,NDCG@5:0.3924) [3009.2 s] 
INFO:root:Load model from ../model/BSARec/BSARec__MovieLens_1M__0__lr=0.0001__l2=1e-06__emb_size=64__num_layers=2__num_heads=4.pt
INFO:root:
Test After Training: (HR@5:0.5459,NDCG@5:0.4090,HR@10:0.6945,NDCG@10:0.4569,HR@20:0.8198,NDCG@20:0.4886,HR@50:0.9596,NDCG@50:0.5167)
INFO:root:
--------------------------------------------- END: 2024-12-29 15:03:05 ---------------------------------------------
INFO:root:Namespace(model_name='BSARec')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 16:33:16 ---------------------------------------------
INFO:root:
=============================================
 Arguments                    | Values       
=============================================
 alpha                        | 0.7         
 attention_probs_dropout_prob | 0.1         
 batch_size                   | 256         
 c                            | 9           
 dataset                      | MovieLens_1M
 dropout                      | 0           
 early_stop                   | 10          
 emb_size                     | 64          
 epoch                        | 200         
 eval_batch_size              | 256         
 gpu                          | 0           
 hidden_dropout_prob          | 0.1         
 hidden_size                  | 64          
 history_max                  | 50          
 l2                           | 1e-06       
 lr                           | 0.0001      
 num_heads                    | 4           
 num_layers                   | 2           
 num_neg                      | 1           
 num_workers                  | 0           
 optimizer                    | Adam        
 random_seed                  | 0           
 test_all                     | 0           
 topk                         | 5,10,20,50  
=============================================
INFO:root:Device: cuda
INFO:root:Load corpus from ../data/MovieLens_1M/SeqReader.pkl
INFO:root:#params: 303680
INFO:root:BSARec(
  (i_embeddings): Embedding(3126, 64)
  (p_embeddings): Embedding(51, 64)
  (transformer_block): ModuleList(
    (0): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.3951 [62.0 s]    dev=(HR@5:0.3396,NDCG@5:0.2266) [0.1 s] *
INFO:root:Epoch 2     loss=0.2994 [57.5 s]    dev=(HR@5:0.3763,NDCG@5:0.2503) [0.1 s] *
INFO:root:Epoch 3     loss=0.2534 [58.7 s]    dev=(HR@5:0.3903,NDCG@5:0.2610) [0.1 s] *
INFO:root:Epoch 4     loss=0.2249 [57.0 s]    dev=(HR@5:0.4180,NDCG@5:0.2842) [0.1 s] *
INFO:root:Epoch 5     loss=0.1982 [58.2 s]    dev=(HR@5:0.4500,NDCG@5:0.3106) [0.1 s] *
INFO:root:Epoch 6     loss=0.1761 [57.4 s]    dev=(HR@5:0.4606,NDCG@5:0.3197) [0.1 s] *
INFO:root:Epoch 7     loss=0.1617 [57.4 s]    dev=(HR@5:0.4711,NDCG@5:0.3325) [0.1 s] *
INFO:root:Epoch 8     loss=0.1495 [58.4 s]    dev=(HR@5:0.4797,NDCG@5:0.3391) [0.1 s] *
INFO:root:Epoch 9     loss=0.1401 [56.4 s]    dev=(HR@5:0.4926,NDCG@5:0.3479) [0.1 s] *
INFO:root:Epoch 10    loss=0.1329 [59.2 s]    dev=(HR@5:0.5023,NDCG@5:0.3564) [0.1 s] *
INFO:root:Epoch 11    loss=0.1278 [57.4 s]    dev=(HR@5:0.5129,NDCG@5:0.3624) [0.1 s] *
INFO:root:Epoch 12    loss=0.1228 [57.4 s]    dev=(HR@5:0.5152,NDCG@5:0.3670) [0.1 s] *
INFO:root:Epoch 13    loss=0.1186 [58.5 s]    dev=(HR@5:0.5176,NDCG@5:0.3695) [0.1 s] *
INFO:root:Epoch 14    loss=0.1146 [57.7 s]    dev=(HR@5:0.5203,NDCG@5:0.3713) [0.1 s] *
INFO:root:Epoch 15    loss=0.1116 [57.3 s]    dev=(HR@5:0.5226,NDCG@5:0.3733) [0.1 s] *
INFO:root:Epoch 16    loss=0.1079 [58.4 s]    dev=(HR@5:0.5308,NDCG@5:0.3799) [0.1 s] *
INFO:root:Epoch 17    loss=0.1055 [57.8 s]    dev=(HR@5:0.5187,NDCG@5:0.3752) [0.1 s]
INFO:root:Epoch 18    loss=0.1031 [58.5 s]    dev=(HR@5:0.5394,NDCG@5:0.3853) [0.1 s] *
INFO:root:Epoch 19    loss=0.1003 [58.6 s]    dev=(HR@5:0.5297,NDCG@5:0.3799) [0.1 s]
INFO:root:Epoch 20    loss=0.0994 [57.6 s]    dev=(HR@5:0.5277,NDCG@5:0.3818) [0.1 s]
INFO:root:Epoch 21    loss=0.0975 [57.3 s]    dev=(HR@5:0.5222,NDCG@5:0.3767) [0.1 s]
INFO:root:Epoch 22    loss=0.0956 [58.0 s]    dev=(HR@5:0.5273,NDCG@5:0.3829) [0.1 s]
INFO:root:Epoch 23    loss=0.0936 [59.2 s]    dev=(HR@5:0.5304,NDCG@5:0.3819) [0.1 s]
INFO:root:Epoch 24    loss=0.0920 [57.7 s]    dev=(HR@5:0.5242,NDCG@5:0.3794) [0.1 s]
INFO:root:Epoch 25    loss=0.0904 [57.3 s]    dev=(HR@5:0.5308,NDCG@5:0.3862) [0.1 s] *
INFO:root:Epoch 26    loss=0.0894 [57.3 s]    dev=(HR@5:0.5343,NDCG@5:0.3833) [0.1 s]
INFO:root:Epoch 27    loss=0.0878 [60.1 s]    dev=(HR@5:0.5394,NDCG@5:0.3884) [0.1 s] *
INFO:root:Epoch 28    loss=0.0878 [57.9 s]    dev=(HR@5:0.5320,NDCG@5:0.3873) [0.1 s]
INFO:root:Epoch 29    loss=0.0865 [57.5 s]    dev=(HR@5:0.5285,NDCG@5:0.3808) [0.1 s]
INFO:root:Epoch 30    loss=0.0858 [59.5 s]    dev=(HR@5:0.5359,NDCG@5:0.3869) [0.1 s]
INFO:root:Epoch 31    loss=0.0848 [57.7 s]    dev=(HR@5:0.5265,NDCG@5:0.3789) [0.1 s]
INFO:root:Epoch 32    loss=0.0836 [58.4 s]    dev=(HR@5:0.5312,NDCG@5:0.3821) [0.1 s]
INFO:root:Epoch 33    loss=0.0819 [58.4 s]    dev=(HR@5:0.5336,NDCG@5:0.3788) [0.1 s]
INFO:root:Epoch 34    loss=0.0813 [58.6 s]    dev=(HR@5:0.5312,NDCG@5:0.3822) [0.1 s]
INFO:root:Epoch 35    loss=0.0818 [58.7 s]    dev=(HR@5:0.5355,NDCG@5:0.3824) [0.1 s]
INFO:root:Epoch 36    loss=0.0792 [58.4 s]    dev=(HR@5:0.5308,NDCG@5:0.3839) [0.1 s]
INFO:root:Epoch 37    loss=0.0800 [57.9 s]    dev=(HR@5:0.5340,NDCG@5:0.3817) [0.1 s]
INFO:root:Epoch 38    loss=0.0795 [57.0 s]    dev=(HR@5:0.5418,NDCG@5:0.3863) [0.1 s]
INFO:root:Epoch 39    loss=0.0784 [59.5 s]    dev=(HR@5:0.5371,NDCG@5:0.3839) [0.1 s]
INFO:root:Epoch 40    loss=0.0781 [57.6 s]    dev=(HR@5:0.5422,NDCG@5:0.3890) [0.1 s] *
INFO:root:Epoch 41    loss=0.0769 [58.4 s]    dev=(HR@5:0.5281,NDCG@5:0.3832) [0.1 s]
INFO:root:Epoch 42    loss=0.0769 [58.7 s]    dev=(HR@5:0.5343,NDCG@5:0.3853) [0.1 s]
INFO:root:Epoch 43    loss=0.0759 [58.0 s]    dev=(HR@5:0.5336,NDCG@5:0.3844) [0.1 s]
INFO:root:Epoch 44    loss=0.0763 [58.2 s]    dev=(HR@5:0.5363,NDCG@5:0.3842) [0.1 s]
INFO:root:Epoch 45    loss=0.0754 [58.3 s]    dev=(HR@5:0.5297,NDCG@5:0.3806) [0.1 s]
INFO:root:Epoch 46    loss=0.0748 [58.5 s]    dev=(HR@5:0.5238,NDCG@5:0.3801) [0.1 s]
INFO:root:Epoch 47    loss=0.0745 [59.2 s]    dev=(HR@5:0.5328,NDCG@5:0.3830) [0.1 s]
INFO:root:Epoch 48    loss=0.0735 [58.4 s]    dev=(HR@5:0.5316,NDCG@5:0.3828) [0.1 s]
INFO:root:Epoch 49    loss=0.0738 [58.8 s]    dev=(HR@5:0.5285,NDCG@5:0.3825) [0.1 s]
INFO:root:Epoch 50    loss=0.0736 [58.5 s]    dev=(HR@5:0.5265,NDCG@5:0.3779) [0.1 s]
INFO:root:Epoch 51    loss=0.0724 [57.3 s]    dev=(HR@5:0.5347,NDCG@5:0.3847) [0.1 s]
INFO:root:Epoch 52    loss=0.0718 [56.9 s]    dev=(HR@5:0.5242,NDCG@5:0.3792) [0.1 s]
INFO:root:Epoch 53    loss=0.0724 [58.0 s]    dev=(HR@5:0.5367,NDCG@5:0.3850) [0.1 s]
INFO:root:Epoch 54    loss=0.0722 [59.2 s]    dev=(HR@5:0.5265,NDCG@5:0.3789) [0.1 s]
INFO:root:Epoch 55    loss=0.0709 [57.7 s]    dev=(HR@5:0.5312,NDCG@5:0.3818) [0.1 s]
INFO:root:Epoch 56    loss=0.0717 [57.7 s]    dev=(HR@5:0.5371,NDCG@5:0.3874) [0.1 s]
INFO:root:Epoch 57    loss=0.0702 [58.1 s]    dev=(HR@5:0.5265,NDCG@5:0.3855) [0.1 s]
INFO:root:Epoch 58    loss=0.0701 [58.0 s]    dev=(HR@5:0.5351,NDCG@5:0.3836) [0.1 s]
INFO:root:Epoch 59    loss=0.0706 [58.6 s]    dev=(HR@5:0.5262,NDCG@5:0.3794) [0.1 s]
INFO:root:Epoch 60    loss=0.0696 [57.0 s]    dev=(HR@5:0.5363,NDCG@5:0.3845) [0.1 s]
INFO:root:Early stop at 60 based on dev result.
INFO:root:
Best Iter(dev)=   40	 dev=(HR@5:0.5422,NDCG@5:0.3890) [3493.8 s] 
INFO:root:Load model from ../model/BSARec/BSARec__MovieLens_1M__0__lr=0.0001__l2=1e-06__emb_size=64__num_layers=2__num_heads=4.pt
INFO:root:
Test After Training: (HR@5:0.5414,NDCG@5:0.4066,HR@10:0.6855,NDCG@10:0.4533,HR@20:0.8239,NDCG@20:0.4884,HR@50:0.9610,NDCG@50:0.5158)
INFO:root:
--------------------------------------------- END: 2024-12-29 17:31:32 ---------------------------------------------
INFO:root:Namespace(model_name='BSARec')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 17:33:28 ---------------------------------------------
INFO:root:
=============================================
 Arguments                    | Values       
=============================================
 alpha                        | 0.9         
 attention_probs_dropout_prob | 0.1         
 batch_size                   | 256         
 c                            | 9           
 dataset                      | MovieLens_1M
 dropout                      | 0           
 early_stop                   | 10          
 emb_size                     | 64          
 epoch                        | 200         
 eval_batch_size              | 256         
 gpu                          | 0           
 hidden_dropout_prob          | 0.1         
 hidden_size                  | 64          
 history_max                  | 20          
 l2                           | 1e-06       
 lr                           | 0.0001      
 num_heads                    | 4           
 num_layers                   | 2           
 num_neg                      | 1           
 num_workers                  | 0           
 optimizer                    | Adam        
 random_seed                  | 0           
 test_all                     | 0           
 topk                         | 5,10,20,50  
=============================================
INFO:root:Device: cuda
INFO:root:Load corpus from ../data/MovieLens_1M/SeqReader.pkl
INFO:root:#params: 301760
INFO:root:BSARec(
  (i_embeddings): Embedding(3126, 64)
  (p_embeddings): Embedding(21, 64)
  (transformer_block): ModuleList(
    (0): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.3984 [58.4 s]    dev=(HR@5:0.3400,NDCG@5:0.2271) [0.1 s] *
INFO:root:Epoch 2     loss=0.3000 [54.7 s]    dev=(HR@5:0.3810,NDCG@5:0.2552) [0.1 s] *
INFO:root:Epoch 3     loss=0.2533 [53.8 s]    dev=(HR@5:0.4005,NDCG@5:0.2663) [0.1 s] *
INFO:root:Epoch 4     loss=0.2219 [54.6 s]    dev=(HR@5:0.4282,NDCG@5:0.2928) [0.1 s] *
INFO:root:Epoch 5     loss=0.1957 [56.0 s]    dev=(HR@5:0.4547,NDCG@5:0.3145) [0.1 s] *
INFO:root:Epoch 6     loss=0.1749 [56.1 s]    dev=(HR@5:0.4641,NDCG@5:0.3238) [0.1 s] *
INFO:root:Epoch 7     loss=0.1615 [55.8 s]    dev=(HR@5:0.4707,NDCG@5:0.3317) [0.1 s] *
INFO:root:Epoch 8     loss=0.1509 [55.4 s]    dev=(HR@5:0.4801,NDCG@5:0.3383) [0.1 s] *
INFO:root:Epoch 9     loss=0.1418 [55.5 s]    dev=(HR@5:0.4879,NDCG@5:0.3461) [0.1 s] *
INFO:root:Epoch 10    loss=0.1349 [56.5 s]    dev=(HR@5:0.4887,NDCG@5:0.3452) [0.1 s]
INFO:root:Epoch 11    loss=0.1297 [54.7 s]    dev=(HR@5:0.4945,NDCG@5:0.3510) [0.1 s] *
INFO:root:Epoch 12    loss=0.1250 [54.3 s]    dev=(HR@5:0.5031,NDCG@5:0.3565) [0.1 s] *
INFO:root:Epoch 13    loss=0.1204 [55.9 s]    dev=(HR@5:0.5086,NDCG@5:0.3613) [0.1 s] *
INFO:root:Epoch 14    loss=0.1166 [55.5 s]    dev=(HR@5:0.5070,NDCG@5:0.3590) [0.1 s]
INFO:root:Epoch 15    loss=0.1137 [55.4 s]    dev=(HR@5:0.5082,NDCG@5:0.3620) [0.1 s] *
INFO:root:Epoch 16    loss=0.1104 [54.6 s]    dev=(HR@5:0.5117,NDCG@5:0.3629) [0.1 s] *
INFO:root:Epoch 17    loss=0.1082 [55.7 s]    dev=(HR@5:0.5152,NDCG@5:0.3694) [0.1 s] *
INFO:root:Epoch 18    loss=0.1057 [56.3 s]    dev=(HR@5:0.5183,NDCG@5:0.3678) [0.1 s]
INFO:root:Epoch 19    loss=0.1033 [55.0 s]    dev=(HR@5:0.5113,NDCG@5:0.3674) [0.1 s]
INFO:root:Epoch 20    loss=0.1018 [54.9 s]    dev=(HR@5:0.5117,NDCG@5:0.3680) [0.1 s]
INFO:root:Epoch 21    loss=0.1005 [54.3 s]    dev=(HR@5:0.5211,NDCG@5:0.3719) [0.1 s] *
INFO:root:Epoch 22    loss=0.0984 [55.7 s]    dev=(HR@5:0.5133,NDCG@5:0.3718) [0.1 s]
INFO:root:Epoch 23    loss=0.0971 [54.7 s]    dev=(HR@5:0.5156,NDCG@5:0.3715) [0.1 s]
INFO:root:Epoch 24    loss=0.0952 [53.9 s]    dev=(HR@5:0.5176,NDCG@5:0.3730) [0.1 s] *
INFO:root:Epoch 25    loss=0.0936 [55.8 s]    dev=(HR@5:0.5137,NDCG@5:0.3691) [0.1 s]
INFO:root:Epoch 26    loss=0.0926 [55.4 s]    dev=(HR@5:0.5117,NDCG@5:0.3672) [0.1 s]
INFO:root:Epoch 27    loss=0.0915 [55.6 s]    dev=(HR@5:0.5101,NDCG@5:0.3621) [0.1 s]
INFO:root:Epoch 28    loss=0.0907 [55.3 s]    dev=(HR@5:0.5082,NDCG@5:0.3618) [0.1 s]
INFO:root:Epoch 29    loss=0.0895 [55.4 s]    dev=(HR@5:0.5156,NDCG@5:0.3658) [0.1 s]
INFO:root:Epoch 30    loss=0.0889 [53.7 s]    dev=(HR@5:0.5219,NDCG@5:0.3672) [0.1 s]
INFO:root:Epoch 31    loss=0.0881 [55.5 s]    dev=(HR@5:0.5160,NDCG@5:0.3691) [0.1 s]
INFO:root:Epoch 32    loss=0.0866 [55.5 s]    dev=(HR@5:0.5074,NDCG@5:0.3658) [0.1 s]
INFO:root:Epoch 33    loss=0.0854 [53.2 s]    dev=(HR@5:0.5199,NDCG@5:0.3703) [0.1 s]
INFO:root:Epoch 34    loss=0.0848 [54.5 s]    dev=(HR@5:0.5137,NDCG@5:0.3657) [0.1 s]
INFO:root:Epoch 35    loss=0.0852 [55.1 s]    dev=(HR@5:0.5137,NDCG@5:0.3654) [0.1 s]
INFO:root:Epoch 36    loss=0.0823 [54.4 s]    dev=(HR@5:0.5074,NDCG@5:0.3627) [0.1 s]
INFO:root:Epoch 37    loss=0.0831 [54.9 s]    dev=(HR@5:0.5109,NDCG@5:0.3675) [0.1 s]
INFO:root:Epoch 38    loss=0.0826 [55.2 s]    dev=(HR@5:0.5082,NDCG@5:0.3650) [0.1 s]
INFO:root:Epoch 39    loss=0.0815 [54.3 s]    dev=(HR@5:0.5129,NDCG@5:0.3661) [0.1 s]
INFO:root:Epoch 40    loss=0.0810 [54.7 s]    dev=(HR@5:0.5094,NDCG@5:0.3664) [0.1 s]
INFO:root:Epoch 41    loss=0.0801 [55.8 s]    dev=(HR@5:0.5117,NDCG@5:0.3643) [0.1 s]
INFO:root:Epoch 42    loss=0.0798 [55.0 s]    dev=(HR@5:0.5059,NDCG@5:0.3648) [0.1 s]
INFO:root:Epoch 43    loss=0.0791 [54.8 s]    dev=(HR@5:0.5125,NDCG@5:0.3664) [0.1 s]
INFO:root:Epoch 44    loss=0.0794 [55.9 s]    dev=(HR@5:0.5043,NDCG@5:0.3614) [0.1 s]
INFO:root:Early stop at 44 based on dev result.
INFO:root:
Best Iter(dev)=   24	 dev=(HR@5:0.5176,NDCG@5:0.3730) [2431.1 s] 
INFO:root:Load model from ../model/BSARec/BSARec__MovieLens_1M__0__lr=0.0001__l2=1e-06__emb_size=64__num_layers=2__num_heads=4.pt
INFO:root:
Test After Training: (HR@5:0.5247,NDCG@5:0.3925,HR@10:0.6649,NDCG@10:0.4380,HR@20:0.8076,NDCG@20:0.4743,HR@50:0.9607,NDCG@50:0.5052)
INFO:root:
--------------------------------------------- END: 2024-12-29 18:14:02 ---------------------------------------------
INFO:root:Namespace(model_name='BSARec')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 18:16:26 ---------------------------------------------
INFO:root:
=============================================
 Arguments                    | Values       
=============================================
 alpha                        | 0.5         
 attention_probs_dropout_prob | 0.1         
 batch_size                   | 256         
 c                            | 3           
 dataset                      | MovieLens_1M
 dropout                      | 0           
 early_stop                   | 10          
 emb_size                     | 64          
 epoch                        | 200         
 eval_batch_size              | 256         
 gpu                          | 0           
 hidden_dropout_prob          | 0.1         
 hidden_size                  | 64          
 history_max                  | 50          
 l2                           | 1e-06       
 lr                           | 0.0001      
 num_heads                    | 4           
 num_layers                   | 2           
 num_neg                      | 1           
 num_workers                  | 0           
 optimizer                    | Adam        
 random_seed                  | 0           
 test_all                     | 0           
 topk                         | 5,10,20,50  
=============================================
INFO:root:Device: cuda
INFO:root:Load corpus from ../data/MovieLens_1M/SeqReader.pkl
INFO:root:#params: 303680
INFO:root:BSARec(
  (i_embeddings): Embedding(3126, 64)
  (p_embeddings): Embedding(51, 64)
  (transformer_block): ModuleList(
    (0): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.3964 [59.7 s]    dev=(HR@5:0.3431,NDCG@5:0.2296) [0.1 s] *
INFO:root:Epoch 2     loss=0.2990 [58.7 s]    dev=(HR@5:0.3786,NDCG@5:0.2498) [0.1 s] *
INFO:root:Epoch 3     loss=0.2524 [59.6 s]    dev=(HR@5:0.3981,NDCG@5:0.2648) [0.1 s] *
INFO:root:Epoch 4     loss=0.2224 [57.9 s]    dev=(HR@5:0.4278,NDCG@5:0.2903) [0.1 s] *
INFO:root:Epoch 5     loss=0.1952 [59.4 s]    dev=(HR@5:0.4578,NDCG@5:0.3184) [0.1 s] *
INFO:root:Epoch 6     loss=0.1747 [58.6 s]    dev=(HR@5:0.4606,NDCG@5:0.3226) [0.1 s] *
INFO:root:Epoch 7     loss=0.1619 [59.8 s]    dev=(HR@5:0.4754,NDCG@5:0.3339) [0.1 s] *
INFO:root:Epoch 8     loss=0.1511 [59.6 s]    dev=(HR@5:0.4711,NDCG@5:0.3334) [0.1 s]
INFO:root:Epoch 9     loss=0.1419 [59.6 s]    dev=(HR@5:0.4840,NDCG@5:0.3406) [0.1 s] *
INFO:root:Epoch 10    loss=0.1351 [57.7 s]    dev=(HR@5:0.4996,NDCG@5:0.3520) [0.1 s] *
INFO:root:Epoch 11    loss=0.1300 [58.2 s]    dev=(HR@5:0.5051,NDCG@5:0.3567) [0.1 s] *
INFO:root:Epoch 12    loss=0.1254 [59.3 s]    dev=(HR@5:0.5129,NDCG@5:0.3623) [0.1 s] *
INFO:root:Epoch 13    loss=0.1212 [59.0 s]    dev=(HR@5:0.5152,NDCG@5:0.3664) [0.1 s] *
INFO:root:Epoch 14    loss=0.1174 [59.1 s]    dev=(HR@5:0.5211,NDCG@5:0.3679) [0.1 s] *
INFO:root:Epoch 15    loss=0.1146 [57.4 s]    dev=(HR@5:0.5183,NDCG@5:0.3673) [0.1 s]
INFO:root:Epoch 16    loss=0.1112 [58.5 s]    dev=(HR@5:0.5254,NDCG@5:0.3759) [0.1 s] *
INFO:root:Epoch 17    loss=0.1086 [58.2 s]    dev=(HR@5:0.5191,NDCG@5:0.3736) [0.1 s]
INFO:root:Epoch 18    loss=0.1060 [59.2 s]    dev=(HR@5:0.5320,NDCG@5:0.3803) [0.1 s] *
INFO:root:Epoch 19    loss=0.1034 [57.3 s]    dev=(HR@5:0.5293,NDCG@5:0.3806) [0.1 s] *
INFO:root:Epoch 20    loss=0.1022 [57.4 s]    dev=(HR@5:0.5297,NDCG@5:0.3800) [0.1 s]
INFO:root:Epoch 21    loss=0.1006 [58.8 s]    dev=(HR@5:0.5238,NDCG@5:0.3776) [0.1 s]
INFO:root:Epoch 22    loss=0.0983 [57.9 s]    dev=(HR@5:0.5347,NDCG@5:0.3857) [0.1 s] *
INFO:root:Epoch 23    loss=0.0966 [58.7 s]    dev=(HR@5:0.5269,NDCG@5:0.3803) [0.1 s]
INFO:root:Epoch 24    loss=0.0948 [58.8 s]    dev=(HR@5:0.5301,NDCG@5:0.3798) [0.1 s]
INFO:root:Epoch 25    loss=0.0932 [55.2 s]    dev=(HR@5:0.5301,NDCG@5:0.3831) [0.1 s]
INFO:root:Epoch 26    loss=0.0919 [57.2 s]    dev=(HR@5:0.5320,NDCG@5:0.3810) [0.1 s]
INFO:root:Epoch 27    loss=0.0906 [58.5 s]    dev=(HR@5:0.5347,NDCG@5:0.3835) [0.1 s]
INFO:root:Epoch 28    loss=0.0903 [59.0 s]    dev=(HR@5:0.5383,NDCG@5:0.3840) [0.1 s]
INFO:root:Epoch 29    loss=0.0888 [58.7 s]    dev=(HR@5:0.5340,NDCG@5:0.3799) [0.1 s]
INFO:root:Epoch 30    loss=0.0885 [60.3 s]    dev=(HR@5:0.5422,NDCG@5:0.3891) [0.1 s] *
INFO:root:Epoch 31    loss=0.0873 [59.0 s]    dev=(HR@5:0.5343,NDCG@5:0.3831) [0.1 s]
INFO:root:Epoch 32    loss=0.0856 [57.5 s]    dev=(HR@5:0.5359,NDCG@5:0.3842) [0.1 s]
INFO:root:Epoch 33    loss=0.0844 [58.4 s]    dev=(HR@5:0.5293,NDCG@5:0.3794) [0.1 s]
INFO:root:Epoch 34    loss=0.0835 [58.3 s]    dev=(HR@5:0.5355,NDCG@5:0.3861) [0.1 s]
INFO:root:Epoch 35    loss=0.0841 [57.0 s]    dev=(HR@5:0.5308,NDCG@5:0.3836) [0.1 s]
INFO:root:Epoch 36    loss=0.0812 [57.0 s]    dev=(HR@5:0.5347,NDCG@5:0.3849) [0.1 s]
INFO:root:Epoch 37    loss=0.0819 [58.8 s]    dev=(HR@5:0.5265,NDCG@5:0.3811) [0.1 s]
INFO:root:Epoch 38    loss=0.0813 [59.5 s]    dev=(HR@5:0.5363,NDCG@5:0.3849) [0.1 s]
INFO:root:Epoch 39    loss=0.0802 [59.2 s]    dev=(HR@5:0.5394,NDCG@5:0.3879) [0.1 s]
INFO:root:Epoch 40    loss=0.0799 [59.8 s]    dev=(HR@5:0.5371,NDCG@5:0.3855) [0.1 s]
INFO:root:Epoch 41    loss=0.0786 [59.3 s]    dev=(HR@5:0.5343,NDCG@5:0.3851) [0.1 s]
INFO:root:Epoch 42    loss=0.0786 [58.0 s]    dev=(HR@5:0.5363,NDCG@5:0.3856) [0.1 s]
INFO:root:Epoch 43    loss=0.0776 [58.6 s]    dev=(HR@5:0.5394,NDCG@5:0.3895) [0.1 s] *
INFO:root:Epoch 44    loss=0.0778 [58.0 s]    dev=(HR@5:0.5359,NDCG@5:0.3859) [0.1 s]
INFO:root:Epoch 45    loss=0.0766 [58.2 s]    dev=(HR@5:0.5355,NDCG@5:0.3868) [0.1 s]
INFO:root:Epoch 46    loss=0.0761 [59.0 s]    dev=(HR@5:0.5297,NDCG@5:0.3831) [0.1 s]
INFO:root:Epoch 47    loss=0.0760 [59.7 s]    dev=(HR@5:0.5308,NDCG@5:0.3840) [0.1 s]
INFO:root:Epoch 48    loss=0.0748 [58.7 s]    dev=(HR@5:0.5347,NDCG@5:0.3849) [0.1 s]
INFO:root:Epoch 49    loss=0.0753 [58.9 s]    dev=(HR@5:0.5269,NDCG@5:0.3829) [0.1 s]
INFO:root:Epoch 50    loss=0.0750 [57.3 s]    dev=(HR@5:0.5262,NDCG@5:0.3779) [0.1 s]
INFO:root:Epoch 51    loss=0.0739 [58.4 s]    dev=(HR@5:0.5297,NDCG@5:0.3797) [0.1 s]
INFO:root:Epoch 52    loss=0.0734 [57.0 s]    dev=(HR@5:0.5203,NDCG@5:0.3756) [0.1 s]
INFO:root:Epoch 53    loss=0.0737 [55.9 s]    dev=(HR@5:0.5340,NDCG@5:0.3853) [0.1 s]
INFO:root:Epoch 54    loss=0.0733 [58.6 s]    dev=(HR@5:0.5285,NDCG@5:0.3790) [0.1 s]
INFO:root:Epoch 55    loss=0.0722 [57.4 s]    dev=(HR@5:0.5230,NDCG@5:0.3785) [0.1 s]
INFO:root:Epoch 56    loss=0.0727 [59.8 s]    dev=(HR@5:0.5332,NDCG@5:0.3879) [0.1 s]
INFO:root:Epoch 57    loss=0.0712 [58.0 s]    dev=(HR@5:0.5379,NDCG@5:0.3849) [0.1 s]
INFO:root:Epoch 58    loss=0.0711 [58.6 s]    dev=(HR@5:0.5343,NDCG@5:0.3826) [0.1 s]
INFO:root:Epoch 59    loss=0.0717 [60.4 s]    dev=(HR@5:0.5254,NDCG@5:0.3814) [0.1 s]
INFO:root:Epoch 60    loss=0.0705 [59.0 s]    dev=(HR@5:0.5386,NDCG@5:0.3849) [0.1 s]
INFO:root:Epoch 61    loss=0.0712 [58.1 s]    dev=(HR@5:0.5332,NDCG@5:0.3803) [0.1 s]
INFO:root:Epoch 62    loss=0.0705 [57.2 s]    dev=(HR@5:0.5312,NDCG@5:0.3809) [0.1 s]
INFO:root:Epoch 63    loss=0.0698 [59.2 s]    dev=(HR@5:0.5277,NDCG@5:0.3793) [0.1 s]
INFO:root:Early stop at 63 based on dev result.
INFO:root:
Best Iter(dev)=   43	 dev=(HR@5:0.5394,NDCG@5:0.3895) [3690.1 s] 
INFO:root:Load model from ../model/BSARec/BSARec__MovieLens_1M__0__lr=0.0001__l2=1e-06__emb_size=64__num_layers=2__num_heads=4.pt
INFO:root:
Test After Training: (HR@5:0.5372,NDCG@5:0.4016,HR@10:0.6834,NDCG@10:0.4489,HR@20:0.8177,NDCG@20:0.4831,HR@50:0.9656,NDCG@50:0.5127)
INFO:root:
--------------------------------------------- END: 2024-12-29 19:17:59 ---------------------------------------------
INFO:root:Namespace(model_name='BSARec')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 19:31:10 ---------------------------------------------
INFO:root:
=============================================
 Arguments                    | Values       
=============================================
 alpha                        | 0.5         
 attention_probs_dropout_prob | 0.1         
 batch_size                   | 256         
 c                            | 5           
 dataset                      | MovieLens_1M
 dropout                      | 0           
 early_stop                   | 10          
 emb_size                     | 64          
 epoch                        | 200         
 eval_batch_size              | 256         
 gpu                          | 0           
 hidden_dropout_prob          | 0.1         
 hidden_size                  | 64          
 history_max                  | 50          
 l2                           | 1e-06       
 lr                           | 0.0001      
 num_heads                    | 4           
 num_layers                   | 2           
 num_neg                      | 1           
 num_workers                  | 0           
 optimizer                    | Adam        
 random_seed                  | 0           
 test_all                     | 0           
 topk                         | 5,10,20,50  
=============================================
INFO:root:Device: cuda
INFO:root:Load corpus from ../data/MovieLens_1M/SeqReader.pkl
INFO:root:#params: 303680
INFO:root:BSARec(
  (i_embeddings): Embedding(3126, 64)
  (p_embeddings): Embedding(51, 64)
  (transformer_block): ModuleList(
    (0): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.3962 [62.1 s]    dev=(HR@5:0.3435,NDCG@5:0.2293) [0.1 s] *
INFO:root:Epoch 2     loss=0.2992 [59.6 s]    dev=(HR@5:0.3813,NDCG@5:0.2508) [0.1 s] *
INFO:root:Epoch 3     loss=0.2532 [59.2 s]    dev=(HR@5:0.3981,NDCG@5:0.2655) [0.1 s] *
INFO:root:Epoch 4     loss=0.2233 [59.9 s]    dev=(HR@5:0.4297,NDCG@5:0.2898) [0.1 s] *
INFO:root:Epoch 5     loss=0.1959 [59.6 s]    dev=(HR@5:0.4520,NDCG@5:0.3142) [0.1 s] *
INFO:root:Epoch 6     loss=0.1752 [58.4 s]    dev=(HR@5:0.4621,NDCG@5:0.3224) [0.1 s] *
INFO:root:Epoch 7     loss=0.1620 [60.2 s]    dev=(HR@5:0.4762,NDCG@5:0.3364) [0.1 s] *
INFO:root:Epoch 8     loss=0.1510 [60.5 s]    dev=(HR@5:0.4758,NDCG@5:0.3352) [0.1 s]
INFO:root:Epoch 9     loss=0.1419 [60.5 s]    dev=(HR@5:0.4859,NDCG@5:0.3453) [0.1 s] *
INFO:root:Epoch 10    loss=0.1349 [59.5 s]    dev=(HR@5:0.4969,NDCG@5:0.3509) [0.1 s] *
INFO:root:Epoch 11    loss=0.1297 [60.8 s]    dev=(HR@5:0.5004,NDCG@5:0.3570) [0.1 s] *
INFO:root:Epoch 12    loss=0.1250 [57.8 s]    dev=(HR@5:0.5074,NDCG@5:0.3621) [0.1 s] *
INFO:root:Epoch 13    loss=0.1208 [60.5 s]    dev=(HR@5:0.5086,NDCG@5:0.3627) [0.1 s] *
INFO:root:Epoch 14    loss=0.1169 [60.3 s]    dev=(HR@5:0.5226,NDCG@5:0.3697) [0.1 s] *
INFO:root:Epoch 15    loss=0.1141 [61.4 s]    dev=(HR@5:0.5219,NDCG@5:0.3694) [0.1 s]
INFO:root:Epoch 16    loss=0.1105 [60.2 s]    dev=(HR@5:0.5285,NDCG@5:0.3762) [0.1 s] *
INFO:root:Epoch 17    loss=0.1080 [61.6 s]    dev=(HR@5:0.5180,NDCG@5:0.3722) [0.1 s]
INFO:root:Epoch 18    loss=0.1054 [60.8 s]    dev=(HR@5:0.5363,NDCG@5:0.3807) [0.1 s] *
INFO:root:Epoch 19    loss=0.1027 [60.4 s]    dev=(HR@5:0.5293,NDCG@5:0.3783) [0.1 s]
INFO:root:Epoch 20    loss=0.1015 [61.5 s]    dev=(HR@5:0.5343,NDCG@5:0.3822) [0.1 s] *
INFO:root:Epoch 21    loss=0.0997 [60.8 s]    dev=(HR@5:0.5285,NDCG@5:0.3802) [0.1 s]
INFO:root:Epoch 22    loss=0.0976 [60.4 s]    dev=(HR@5:0.5281,NDCG@5:0.3827) [0.1 s] *
INFO:root:Epoch 23    loss=0.0959 [61.0 s]    dev=(HR@5:0.5250,NDCG@5:0.3796) [0.1 s]
INFO:root:Epoch 24    loss=0.0942 [61.3 s]    dev=(HR@5:0.5320,NDCG@5:0.3840) [0.1 s] *
INFO:root:Epoch 25    loss=0.0926 [60.4 s]    dev=(HR@5:0.5340,NDCG@5:0.3861) [0.1 s] *
INFO:root:Epoch 26    loss=0.0914 [61.2 s]    dev=(HR@5:0.5328,NDCG@5:0.3805) [0.1 s]
INFO:root:Epoch 27    loss=0.0902 [60.5 s]    dev=(HR@5:0.5312,NDCG@5:0.3849) [0.1 s]
INFO:root:Epoch 28    loss=0.0896 [60.2 s]    dev=(HR@5:0.5304,NDCG@5:0.3828) [0.1 s]
INFO:root:Epoch 29    loss=0.0883 [61.4 s]    dev=(HR@5:0.5304,NDCG@5:0.3803) [0.1 s]
INFO:root:Epoch 30    loss=0.0877 [61.1 s]    dev=(HR@5:0.5328,NDCG@5:0.3871) [0.1 s] *
INFO:root:Epoch 31    loss=0.0866 [60.2 s]    dev=(HR@5:0.5293,NDCG@5:0.3824) [0.1 s]
INFO:root:Epoch 32    loss=0.0852 [62.3 s]    dev=(HR@5:0.5289,NDCG@5:0.3845) [0.1 s]
INFO:root:Epoch 33    loss=0.0837 [62.4 s]    dev=(HR@5:0.5262,NDCG@5:0.3791) [0.1 s]
INFO:root:Epoch 34    loss=0.0830 [60.7 s]    dev=(HR@5:0.5277,NDCG@5:0.3815) [0.1 s]
INFO:root:Epoch 35    loss=0.0835 [62.1 s]    dev=(HR@5:0.5347,NDCG@5:0.3837) [0.1 s]
INFO:root:Epoch 36    loss=0.0806 [62.2 s]    dev=(HR@5:0.5363,NDCG@5:0.3844) [0.1 s]
INFO:root:Epoch 37    loss=0.0816 [61.8 s]    dev=(HR@5:0.5359,NDCG@5:0.3832) [0.1 s]
INFO:root:Epoch 38    loss=0.0807 [61.4 s]    dev=(HR@5:0.5375,NDCG@5:0.3857) [0.1 s]
INFO:root:Epoch 39    loss=0.0798 [61.2 s]    dev=(HR@5:0.5355,NDCG@5:0.3875) [0.1 s] *
INFO:root:Epoch 40    loss=0.0794 [60.9 s]    dev=(HR@5:0.5406,NDCG@5:0.3864) [0.1 s]
INFO:root:Epoch 41    loss=0.0781 [60.0 s]    dev=(HR@5:0.5347,NDCG@5:0.3883) [0.1 s] *
INFO:root:Epoch 42    loss=0.0781 [60.5 s]    dev=(HR@5:0.5355,NDCG@5:0.3855) [0.1 s]
INFO:root:Epoch 43    loss=0.0771 [61.2 s]    dev=(HR@5:0.5398,NDCG@5:0.3884) [0.1 s] *
INFO:root:Epoch 44    loss=0.0774 [61.3 s]    dev=(HR@5:0.5351,NDCG@5:0.3834) [0.1 s]
INFO:root:Epoch 45    loss=0.0763 [60.1 s]    dev=(HR@5:0.5316,NDCG@5:0.3820) [0.1 s]
INFO:root:Epoch 46    loss=0.0756 [60.2 s]    dev=(HR@5:0.5265,NDCG@5:0.3799) [0.1 s]
INFO:root:Epoch 47    loss=0.0756 [61.9 s]    dev=(HR@5:0.5301,NDCG@5:0.3842) [0.1 s]
INFO:root:Epoch 48    loss=0.0745 [61.6 s]    dev=(HR@5:0.5383,NDCG@5:0.3871) [0.1 s]
INFO:root:Epoch 49    loss=0.0751 [62.3 s]    dev=(HR@5:0.5320,NDCG@5:0.3849) [0.1 s]
INFO:root:Epoch 50    loss=0.0746 [61.3 s]    dev=(HR@5:0.5265,NDCG@5:0.3820) [0.1 s]
INFO:root:Epoch 51    loss=0.0735 [62.5 s]    dev=(HR@5:0.5320,NDCG@5:0.3798) [0.1 s]
INFO:root:Epoch 52    loss=0.0731 [59.9 s]    dev=(HR@5:0.5254,NDCG@5:0.3800) [0.1 s]
INFO:root:Epoch 53    loss=0.0736 [60.8 s]    dev=(HR@5:0.5324,NDCG@5:0.3850) [0.1 s]
INFO:root:Epoch 54    loss=0.0728 [61.5 s]    dev=(HR@5:0.5234,NDCG@5:0.3793) [0.1 s]
INFO:root:Epoch 55    loss=0.0718 [60.6 s]    dev=(HR@5:0.5234,NDCG@5:0.3805) [0.1 s]
INFO:root:Epoch 56    loss=0.0725 [59.9 s]    dev=(HR@5:0.5347,NDCG@5:0.3865) [0.1 s]
INFO:root:Epoch 57    loss=0.0707 [61.4 s]    dev=(HR@5:0.5254,NDCG@5:0.3811) [0.1 s]
INFO:root:Epoch 58    loss=0.0710 [60.0 s]    dev=(HR@5:0.5293,NDCG@5:0.3793) [0.1 s]
INFO:root:Epoch 59    loss=0.0715 [59.9 s]    dev=(HR@5:0.5269,NDCG@5:0.3774) [0.1 s]
INFO:root:Epoch 60    loss=0.0704 [60.7 s]    dev=(HR@5:0.5363,NDCG@5:0.3854) [0.1 s]
INFO:root:Epoch 61    loss=0.0710 [61.3 s]    dev=(HR@5:0.5246,NDCG@5:0.3770) [0.1 s]
INFO:root:Epoch 62    loss=0.0703 [59.9 s]    dev=(HR@5:0.5238,NDCG@5:0.3775) [0.1 s]
INFO:root:Epoch 63    loss=0.0698 [61.4 s]    dev=(HR@5:0.5277,NDCG@5:0.3806) [0.1 s]
INFO:root:Early stop at 63 based on dev result.
INFO:root:
Best Iter(dev)=   43	 dev=(HR@5:0.5398,NDCG@5:0.3884) [3833.7 s] 
INFO:root:Load model from ../model/BSARec/BSARec__MovieLens_1M__0__lr=0.0001__l2=1e-06__emb_size=64__num_layers=2__num_heads=4.pt
INFO:root:
Test After Training: (HR@5:0.5362,NDCG@5:0.4031,HR@10:0.6858,NDCG@10:0.4516,HR@20:0.8222,NDCG@20:0.4863,HR@50:0.9610,NDCG@50:0.5140)
INFO:root:
--------------------------------------------- END: 2024-12-29 20:35:06 ---------------------------------------------
INFO:root:Namespace(model_name='BSARec')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 21:31:51 ---------------------------------------------
INFO:root:
=============================================
 Arguments                    | Values       
=============================================
 alpha                        | 0.3         
 attention_probs_dropout_prob | 0.1         
 batch_size                   | 256         
 c                            | 3           
 dataset                      | MovieLens_1M
 dropout                      | 0           
 early_stop                   | 10          
 emb_size                     | 64          
 epoch                        | 200         
 eval_batch_size              | 256         
 gpu                          | 0           
 hidden_dropout_prob          | 0.1         
 hidden_size                  | 64          
 history_max                  | 50          
 l2                           | 1e-06       
 lr                           | 0.0001      
 num_heads                    | 4           
 num_layers                   | 2           
 num_neg                      | 1           
 num_workers                  | 0           
 optimizer                    | Adam        
 random_seed                  | 0           
 test_all                     | 0           
 topk                         | 5,10,20,50  
=============================================
INFO:root:Device: cuda
INFO:root:Load corpus from ../data/MovieLens_1M/SeqReader.pkl
INFO:root:#params: 303680
INFO:root:BSARec(
  (i_embeddings): Embedding(3126, 64)
  (p_embeddings): Embedding(51, 64)
  (transformer_block): ModuleList(
    (0): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.3983 [61.1 s]    dev=(HR@5:0.3411,NDCG@5:0.2288) [0.1 s] *
INFO:root:Epoch 2     loss=0.2989 [57.9 s]    dev=(HR@5:0.3833,NDCG@5:0.2527) [0.1 s] *
INFO:root:Epoch 3     loss=0.2509 [59.1 s]    dev=(HR@5:0.3966,NDCG@5:0.2636) [0.1 s] *
INFO:root:Epoch 4     loss=0.2200 [57.3 s]    dev=(HR@5:0.4325,NDCG@5:0.2960) [0.1 s] *
INFO:root:Epoch 5     loss=0.1924 [58.6 s]    dev=(HR@5:0.4590,NDCG@5:0.3192) [0.1 s] *
INFO:root:Epoch 6     loss=0.1725 [57.2 s]    dev=(HR@5:0.4629,NDCG@5:0.3247) [0.1 s] *
INFO:root:Epoch 7     loss=0.1601 [60.3 s]    dev=(HR@5:0.4715,NDCG@5:0.3353) [0.1 s] *
INFO:root:Epoch 8     loss=0.1498 [59.1 s]    dev=(HR@5:0.4711,NDCG@5:0.3342) [0.1 s]
INFO:root:Epoch 9     loss=0.1410 [59.2 s]    dev=(HR@5:0.4914,NDCG@5:0.3476) [0.1 s] *
INFO:root:Epoch 10    loss=0.1346 [58.9 s]    dev=(HR@5:0.5000,NDCG@5:0.3532) [0.1 s] *
INFO:root:Epoch 11    loss=0.1298 [58.2 s]    dev=(HR@5:0.5035,NDCG@5:0.3565) [0.1 s] *
INFO:root:Epoch 12    loss=0.1251 [57.7 s]    dev=(HR@5:0.5078,NDCG@5:0.3607) [0.1 s] *
INFO:root:Epoch 13    loss=0.1212 [59.0 s]    dev=(HR@5:0.5164,NDCG@5:0.3668) [0.1 s] *
INFO:root:Epoch 14    loss=0.1175 [57.4 s]    dev=(HR@5:0.5238,NDCG@5:0.3708) [0.1 s] *
INFO:root:Epoch 15    loss=0.1147 [58.4 s]    dev=(HR@5:0.5183,NDCG@5:0.3683) [0.1 s]
INFO:root:Epoch 16    loss=0.1112 [58.3 s]    dev=(HR@5:0.5285,NDCG@5:0.3768) [0.1 s] *
INFO:root:Epoch 17    loss=0.1090 [57.6 s]    dev=(HR@5:0.5156,NDCG@5:0.3716) [0.1 s]
INFO:root:Epoch 18    loss=0.1064 [59.1 s]    dev=(HR@5:0.5273,NDCG@5:0.3793) [0.1 s] *
INFO:root:Epoch 19    loss=0.1037 [57.9 s]    dev=(HR@5:0.5199,NDCG@5:0.3744) [0.1 s]
INFO:root:Epoch 20    loss=0.1027 [58.7 s]    dev=(HR@5:0.5195,NDCG@5:0.3744) [0.1 s]
INFO:root:Epoch 21    loss=0.1011 [58.1 s]    dev=(HR@5:0.5211,NDCG@5:0.3767) [0.1 s]
INFO:root:Epoch 22    loss=0.0989 [57.8 s]    dev=(HR@5:0.5215,NDCG@5:0.3801) [0.1 s] *
INFO:root:Epoch 23    loss=0.0973 [57.5 s]    dev=(HR@5:0.5168,NDCG@5:0.3742) [0.1 s]
INFO:root:Epoch 24    loss=0.0956 [58.4 s]    dev=(HR@5:0.5238,NDCG@5:0.3760) [0.1 s]
INFO:root:Epoch 25    loss=0.0940 [56.8 s]    dev=(HR@5:0.5242,NDCG@5:0.3795) [0.1 s]
INFO:root:Epoch 26    loss=0.0929 [59.0 s]    dev=(HR@5:0.5187,NDCG@5:0.3751) [0.1 s]
INFO:root:Epoch 27    loss=0.0917 [58.5 s]    dev=(HR@5:0.5211,NDCG@5:0.3751) [0.1 s]
INFO:root:Epoch 28    loss=0.0911 [56.8 s]    dev=(HR@5:0.5246,NDCG@5:0.3774) [0.1 s]
INFO:root:Epoch 29    loss=0.0898 [58.3 s]    dev=(HR@5:0.5222,NDCG@5:0.3724) [0.1 s]
INFO:root:Epoch 30    loss=0.0895 [59.6 s]    dev=(HR@5:0.5312,NDCG@5:0.3816) [0.1 s] *
INFO:root:Epoch 31    loss=0.0885 [58.8 s]    dev=(HR@5:0.5195,NDCG@5:0.3759) [0.1 s]
INFO:root:Epoch 32    loss=0.0868 [58.5 s]    dev=(HR@5:0.5262,NDCG@5:0.3782) [0.1 s]
INFO:root:Epoch 33    loss=0.0857 [58.3 s]    dev=(HR@5:0.5222,NDCG@5:0.3760) [0.1 s]
INFO:root:Epoch 34    loss=0.0848 [59.0 s]    dev=(HR@5:0.5254,NDCG@5:0.3787) [0.1 s]
INFO:root:Epoch 35    loss=0.0854 [57.9 s]    dev=(HR@5:0.5277,NDCG@5:0.3788) [0.1 s]
INFO:root:Epoch 36    loss=0.0824 [59.7 s]    dev=(HR@5:0.5250,NDCG@5:0.3809) [0.1 s]
INFO:root:Epoch 37    loss=0.0835 [59.4 s]    dev=(HR@5:0.5289,NDCG@5:0.3807) [0.1 s]
INFO:root:Epoch 38    loss=0.0826 [57.4 s]    dev=(HR@5:0.5316,NDCG@5:0.3814) [0.1 s]
INFO:root:Epoch 39    loss=0.0816 [59.3 s]    dev=(HR@5:0.5336,NDCG@5:0.3827) [0.1 s] *
INFO:root:Epoch 40    loss=0.0814 [59.7 s]    dev=(HR@5:0.5332,NDCG@5:0.3797) [0.1 s]
INFO:root:Epoch 41    loss=0.0799 [58.9 s]    dev=(HR@5:0.5297,NDCG@5:0.3793) [0.1 s]
INFO:root:Epoch 42    loss=0.0798 [58.6 s]    dev=(HR@5:0.5297,NDCG@5:0.3810) [0.1 s]
INFO:root:Epoch 43    loss=0.0789 [59.8 s]    dev=(HR@5:0.5347,NDCG@5:0.3841) [0.1 s] *
INFO:root:Epoch 44    loss=0.0794 [58.7 s]    dev=(HR@5:0.5304,NDCG@5:0.3812) [0.1 s]
INFO:root:Epoch 45    loss=0.0780 [57.8 s]    dev=(HR@5:0.5254,NDCG@5:0.3787) [0.1 s]
INFO:root:Epoch 46    loss=0.0775 [59.1 s]    dev=(HR@5:0.5277,NDCG@5:0.3790) [0.1 s]
INFO:root:Epoch 47    loss=0.0775 [60.0 s]    dev=(HR@5:0.5293,NDCG@5:0.3830) [0.1 s]
INFO:root:Epoch 48    loss=0.0763 [59.5 s]    dev=(HR@5:0.5242,NDCG@5:0.3793) [0.1 s]
INFO:root:Epoch 49    loss=0.0765 [58.8 s]    dev=(HR@5:0.5277,NDCG@5:0.3807) [0.1 s]
INFO:root:Epoch 50    loss=0.0763 [57.2 s]    dev=(HR@5:0.5289,NDCG@5:0.3790) [0.1 s]
INFO:root:Epoch 51    loss=0.0753 [57.9 s]    dev=(HR@5:0.5250,NDCG@5:0.3740) [0.1 s]
INFO:root:Epoch 52    loss=0.0747 [58.6 s]    dev=(HR@5:0.5172,NDCG@5:0.3733) [0.1 s]
INFO:root:Epoch 53    loss=0.0751 [57.6 s]    dev=(HR@5:0.5250,NDCG@5:0.3791) [0.1 s]
INFO:root:Epoch 54    loss=0.0745 [60.2 s]    dev=(HR@5:0.5222,NDCG@5:0.3750) [0.1 s]
INFO:root:Epoch 55    loss=0.0737 [59.8 s]    dev=(HR@5:0.5242,NDCG@5:0.3755) [0.1 s]
INFO:root:Epoch 56    loss=0.0744 [56.6 s]    dev=(HR@5:0.5293,NDCG@5:0.3823) [0.1 s]
INFO:root:Epoch 57    loss=0.0726 [58.9 s]    dev=(HR@5:0.5254,NDCG@5:0.3783) [0.1 s]
INFO:root:Epoch 58    loss=0.0726 [57.9 s]    dev=(HR@5:0.5340,NDCG@5:0.3804) [0.1 s]
INFO:root:Epoch 59    loss=0.0731 [58.4 s]    dev=(HR@5:0.5269,NDCG@5:0.3767) [0.1 s]
INFO:root:Epoch 60    loss=0.0721 [58.8 s]    dev=(HR@5:0.5277,NDCG@5:0.3794) [0.1 s]
INFO:root:Epoch 61    loss=0.0725 [57.4 s]    dev=(HR@5:0.5258,NDCG@5:0.3739) [0.1 s]
INFO:root:Epoch 62    loss=0.0720 [56.5 s]    dev=(HR@5:0.5226,NDCG@5:0.3755) [0.1 s]
INFO:root:Epoch 63    loss=0.0715 [57.4 s]    dev=(HR@5:0.5293,NDCG@5:0.3789) [0.1 s]
INFO:root:Early stop at 63 based on dev result.
INFO:root:
Best Iter(dev)=   43	 dev=(HR@5:0.5347,NDCG@5:0.3841) [3689.1 s] 
INFO:root:Load model from ../model/BSARec/BSARec__MovieLens_1M__0__lr=0.0001__l2=1e-06__emb_size=64__num_layers=2__num_heads=4.pt
INFO:root:
Test After Training: (HR@5:0.5303,NDCG@5:0.3971,HR@10:0.6768,NDCG@10:0.4447,HR@20:0.8215,NDCG@20:0.4816,HR@50:0.9656,NDCG@50:0.5103)
INFO:root:
--------------------------------------------- END: 2024-12-29 22:33:23 ---------------------------------------------
INFO:root:Namespace(model_name='BSARec')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 22:42:41 ---------------------------------------------
INFO:root:
=============================================
 Arguments                    | Values       
=============================================
 alpha                        | 0.7         
 attention_probs_dropout_prob | 0.1         
 batch_size                   | 256         
 c                            | 7           
 dataset                      | MovieLens_1M
 dropout                      | 0           
 early_stop                   | 10          
 emb_size                     | 64          
 epoch                        | 200         
 eval_batch_size              | 256         
 gpu                          | 0           
 hidden_dropout_prob          | 0.1         
 hidden_size                  | 64          
 history_max                  | 20          
 l2                           | 1e-06       
 lr                           | 0.0001      
 num_heads                    | 4           
 num_layers                   | 2           
 num_neg                      | 1           
 num_workers                  | 0           
 optimizer                    | Adam        
 random_seed                  | 0           
 test_all                     | 0           
 topk                         | 5,10,20,50  
=============================================
INFO:root:Device: cuda
INFO:root:Load corpus from ../data/MovieLens_1M/SeqReader.pkl
INFO:root:#params: 301760
INFO:root:BSARec(
  (i_embeddings): Embedding(3126, 64)
  (p_embeddings): Embedding(21, 64)
  (transformer_block): ModuleList(
    (0): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.3996 [56.6 s]    dev=(HR@5:0.3404,NDCG@5:0.2281) [0.1 s] *
INFO:root:Epoch 2     loss=0.2973 [57.0 s]    dev=(HR@5:0.3817,NDCG@5:0.2576) [0.1 s] *
INFO:root:Epoch 3     loss=0.2500 [56.2 s]    dev=(HR@5:0.4048,NDCG@5:0.2708) [0.1 s] *
INFO:root:Epoch 4     loss=0.2181 [55.2 s]    dev=(HR@5:0.4360,NDCG@5:0.2992) [0.1 s] *
INFO:root:Epoch 5     loss=0.1906 [56.0 s]    dev=(HR@5:0.4578,NDCG@5:0.3191) [0.1 s] *
INFO:root:Epoch 6     loss=0.1703 [55.0 s]    dev=(HR@5:0.4711,NDCG@5:0.3284) [0.1 s] *
INFO:root:Epoch 7     loss=0.1579 [55.9 s]    dev=(HR@5:0.4801,NDCG@5:0.3369) [0.1 s] *
INFO:root:Epoch 8     loss=0.1479 [55.4 s]    dev=(HR@5:0.4859,NDCG@5:0.3445) [0.1 s] *
INFO:root:Epoch 9     loss=0.1391 [55.7 s]    dev=(HR@5:0.4930,NDCG@5:0.3495) [0.1 s] *
INFO:root:Epoch 10    loss=0.1328 [55.4 s]    dev=(HR@5:0.4977,NDCG@5:0.3519) [0.1 s] *
INFO:root:Epoch 11    loss=0.1280 [54.8 s]    dev=(HR@5:0.4980,NDCG@5:0.3546) [0.1 s] *
INFO:root:Epoch 12    loss=0.1233 [57.2 s]    dev=(HR@5:0.5051,NDCG@5:0.3591) [0.1 s] *
INFO:root:Epoch 13    loss=0.1189 [53.1 s]    dev=(HR@5:0.5195,NDCG@5:0.3650) [0.1 s] *
INFO:root:Epoch 14    loss=0.1153 [55.5 s]    dev=(HR@5:0.5113,NDCG@5:0.3660) [0.1 s] *
INFO:root:Epoch 15    loss=0.1125 [56.0 s]    dev=(HR@5:0.5203,NDCG@5:0.3716) [0.1 s] *
INFO:root:Epoch 16    loss=0.1091 [55.5 s]    dev=(HR@5:0.5195,NDCG@5:0.3722) [0.1 s] *
INFO:root:Epoch 17    loss=0.1073 [55.4 s]    dev=(HR@5:0.5195,NDCG@5:0.3743) [0.1 s] *
INFO:root:Epoch 18    loss=0.1048 [55.9 s]    dev=(HR@5:0.5234,NDCG@5:0.3776) [0.1 s] *
INFO:root:Epoch 19    loss=0.1021 [56.3 s]    dev=(HR@5:0.5203,NDCG@5:0.3780) [0.1 s] *
INFO:root:Epoch 20    loss=0.1009 [57.0 s]    dev=(HR@5:0.5187,NDCG@5:0.3744) [0.1 s]
INFO:root:Epoch 21    loss=0.0994 [54.9 s]    dev=(HR@5:0.5222,NDCG@5:0.3753) [0.1 s]
INFO:root:Epoch 22    loss=0.0977 [55.3 s]    dev=(HR@5:0.5254,NDCG@5:0.3773) [0.1 s]
INFO:root:Epoch 23    loss=0.0962 [55.6 s]    dev=(HR@5:0.5250,NDCG@5:0.3786) [0.1 s] *
INFO:root:Epoch 24    loss=0.0945 [54.7 s]    dev=(HR@5:0.5297,NDCG@5:0.3809) [0.1 s] *
INFO:root:Epoch 25    loss=0.0929 [55.3 s]    dev=(HR@5:0.5215,NDCG@5:0.3757) [0.1 s]
INFO:root:Epoch 26    loss=0.0919 [54.1 s]    dev=(HR@5:0.5187,NDCG@5:0.3725) [0.1 s]
INFO:root:Epoch 27    loss=0.0904 [56.5 s]    dev=(HR@5:0.5187,NDCG@5:0.3725) [0.1 s]
INFO:root:Epoch 28    loss=0.0898 [55.5 s]    dev=(HR@5:0.5152,NDCG@5:0.3689) [0.1 s]
INFO:root:Epoch 29    loss=0.0890 [56.8 s]    dev=(HR@5:0.5250,NDCG@5:0.3721) [0.1 s]
INFO:root:Epoch 30    loss=0.0883 [54.8 s]    dev=(HR@5:0.5226,NDCG@5:0.3729) [0.1 s]
INFO:root:Epoch 31    loss=0.0872 [56.0 s]    dev=(HR@5:0.5222,NDCG@5:0.3745) [0.1 s]
INFO:root:Epoch 32    loss=0.0858 [54.8 s]    dev=(HR@5:0.5180,NDCG@5:0.3730) [0.1 s]
INFO:root:Epoch 33    loss=0.0846 [56.4 s]    dev=(HR@5:0.5164,NDCG@5:0.3713) [0.1 s]
INFO:root:Epoch 34    loss=0.0841 [55.3 s]    dev=(HR@5:0.5238,NDCG@5:0.3738) [0.1 s]
INFO:root:Epoch 35    loss=0.0843 [53.4 s]    dev=(HR@5:0.5277,NDCG@5:0.3743) [0.1 s]
INFO:root:Epoch 36    loss=0.0818 [57.1 s]    dev=(HR@5:0.5160,NDCG@5:0.3697) [0.1 s]
INFO:root:Epoch 37    loss=0.0826 [53.6 s]    dev=(HR@5:0.5211,NDCG@5:0.3753) [0.1 s]
INFO:root:Epoch 38    loss=0.0821 [56.4 s]    dev=(HR@5:0.5215,NDCG@5:0.3745) [0.1 s]
INFO:root:Epoch 39    loss=0.0809 [55.6 s]    dev=(HR@5:0.5238,NDCG@5:0.3741) [0.1 s]
INFO:root:Epoch 40    loss=0.0805 [57.5 s]    dev=(HR@5:0.5250,NDCG@5:0.3735) [0.1 s]
INFO:root:Epoch 41    loss=0.0795 [56.9 s]    dev=(HR@5:0.5269,NDCG@5:0.3778) [0.1 s]
INFO:root:Epoch 42    loss=0.0794 [55.5 s]    dev=(HR@5:0.5297,NDCG@5:0.3774) [0.1 s]
INFO:root:Epoch 43    loss=0.0786 [54.2 s]    dev=(HR@5:0.5289,NDCG@5:0.3770) [0.1 s]
INFO:root:Epoch 44    loss=0.0786 [54.0 s]    dev=(HR@5:0.5168,NDCG@5:0.3677) [0.1 s]
INFO:root:Early stop at 44 based on dev result.
INFO:root:
Best Iter(dev)=   24	 dev=(HR@5:0.5297,NDCG@5:0.3809) [2448.8 s] 
INFO:root:Load model from ../model/BSARec/BSARec__MovieLens_1M__0__lr=0.0001__l2=1e-06__emb_size=64__num_layers=2__num_heads=4.pt
INFO:root:
Test After Training: (HR@5:0.5320,NDCG@5:0.3972,HR@10:0.6747,NDCG@10:0.4432,HR@20:0.8173,NDCG@20:0.4792,HR@50:0.9593,NDCG@50:0.5077)
INFO:root:
--------------------------------------------- END: 2024-12-29 23:23:33 ---------------------------------------------
INFO:root:Namespace(model_name='BSARec')
INFO:root:--------------------------------------------- BEGIN: 2024-12-29 23:34:26 ---------------------------------------------
INFO:root:
=============================================
 Arguments                    | Values       
=============================================
 alpha                        | 0.3         
 attention_probs_dropout_prob | 0.1         
 batch_size                   | 256         
 c                            | 3           
 dataset                      | MovieLens_1M
 dropout                      | 0           
 early_stop                   | 10          
 emb_size                     | 64          
 epoch                        | 200         
 eval_batch_size              | 256         
 gpu                          | 0           
 hidden_dropout_prob          | 0.1         
 hidden_size                  | 64          
 history_max                  | 50          
 l2                           | 1e-06       
 lr                           | 0.0001      
 num_heads                    | 4           
 num_layers                   | 2           
 num_neg                      | 1           
 num_workers                  | 0           
 optimizer                    | Adam        
 random_seed                  | 0           
 test_all                     | 0           
 topk                         | 5,10,20,50  
=============================================
INFO:root:Device: cuda
INFO:root:Load corpus from ../data/MovieLens_1M/SeqReader.pkl
INFO:root:#params: 303680
INFO:root:BSARec(
  (i_embeddings): Embedding(3126, 64)
  (p_embeddings): Embedding(51, 64)
  (transformer_block): ModuleList(
    (0): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.3983 [61.2 s]    dev=(HR@5:0.3411,NDCG@5:0.2288) [0.1 s] *
INFO:root:Epoch 2     loss=0.2989 [58.4 s]    dev=(HR@5:0.3833,NDCG@5:0.2527) [0.1 s] *
INFO:root:Epoch 3     loss=0.2509 [58.4 s]    dev=(HR@5:0.3966,NDCG@5:0.2636) [0.1 s] *
INFO:root:Epoch 4     loss=0.2200 [58.3 s]    dev=(HR@5:0.4325,NDCG@5:0.2960) [0.1 s] *
INFO:root:Epoch 5     loss=0.1924 [58.6 s]    dev=(HR@5:0.4590,NDCG@5:0.3192) [0.1 s] *
INFO:root:Epoch 6     loss=0.1725 [57.3 s]    dev=(HR@5:0.4629,NDCG@5:0.3247) [0.1 s] *
INFO:root:Epoch 7     loss=0.1601 [58.6 s]    dev=(HR@5:0.4715,NDCG@5:0.3353) [0.1 s] *
INFO:root:Epoch 8     loss=0.1498 [59.0 s]    dev=(HR@5:0.4711,NDCG@5:0.3342) [0.1 s]
INFO:root:Epoch 9     loss=0.1410 [58.3 s]    dev=(HR@5:0.4914,NDCG@5:0.3476) [0.1 s] *
INFO:root:Epoch 10    loss=0.1346 [58.2 s]    dev=(HR@5:0.5000,NDCG@5:0.3532) [0.1 s] *
INFO:root:Epoch 11    loss=0.1298 [57.9 s]    dev=(HR@5:0.5035,NDCG@5:0.3565) [0.1 s] *
INFO:root:Epoch 12    loss=0.1251 [58.2 s]    dev=(HR@5:0.5078,NDCG@5:0.3607) [0.1 s] *
INFO:root:Epoch 13    loss=0.1212 [57.9 s]    dev=(HR@5:0.5164,NDCG@5:0.3668) [0.1 s] *
INFO:root:Epoch 14    loss=0.1175 [58.4 s]    dev=(HR@5:0.5238,NDCG@5:0.3708) [0.1 s] *
INFO:root:Epoch 15    loss=0.1147 [57.7 s]    dev=(HR@5:0.5183,NDCG@5:0.3683) [0.1 s]
INFO:root:Epoch 16    loss=0.1112 [57.7 s]    dev=(HR@5:0.5285,NDCG@5:0.3768) [0.1 s] *
INFO:root:Epoch 17    loss=0.1090 [57.7 s]    dev=(HR@5:0.5156,NDCG@5:0.3716) [0.1 s]
INFO:root:Epoch 18    loss=0.1064 [59.3 s]    dev=(HR@5:0.5273,NDCG@5:0.3793) [0.1 s] *
INFO:root:Epoch 19    loss=0.1037 [57.6 s]    dev=(HR@5:0.5199,NDCG@5:0.3744) [0.1 s]
INFO:root:Epoch 20    loss=0.1027 [57.6 s]    dev=(HR@5:0.5195,NDCG@5:0.3744) [0.1 s]
INFO:root:Epoch 21    loss=0.1011 [58.5 s]    dev=(HR@5:0.5211,NDCG@5:0.3767) [0.1 s]
INFO:root:Epoch 22    loss=0.0989 [56.9 s]    dev=(HR@5:0.5215,NDCG@5:0.3801) [0.1 s] *
INFO:root:Epoch 23    loss=0.0973 [57.9 s]    dev=(HR@5:0.5168,NDCG@5:0.3742) [0.1 s]
INFO:root:Epoch 24    loss=0.0956 [59.4 s]    dev=(HR@5:0.5238,NDCG@5:0.3760) [0.1 s]
INFO:root:Epoch 25    loss=0.0940 [58.8 s]    dev=(HR@5:0.5242,NDCG@5:0.3795) [0.1 s]
INFO:root:Epoch 26    loss=0.0929 [58.4 s]    dev=(HR@5:0.5187,NDCG@5:0.3751) [0.1 s]
INFO:root:Epoch 27    loss=0.0917 [58.7 s]    dev=(HR@5:0.5211,NDCG@5:0.3751) [0.1 s]
INFO:root:Epoch 28    loss=0.0911 [57.9 s]    dev=(HR@5:0.5246,NDCG@5:0.3774) [0.1 s]
INFO:root:Epoch 29    loss=0.0898 [57.6 s]    dev=(HR@5:0.5222,NDCG@5:0.3724) [0.1 s]
INFO:root:Epoch 30    loss=0.0895 [59.0 s]    dev=(HR@5:0.5312,NDCG@5:0.3816) [0.1 s] *
INFO:root:Epoch 31    loss=0.0885 [58.8 s]    dev=(HR@5:0.5195,NDCG@5:0.3759) [0.1 s]
INFO:root:Epoch 32    loss=0.0868 [57.8 s]    dev=(HR@5:0.5262,NDCG@5:0.3782) [0.1 s]
INFO:root:Epoch 33    loss=0.0857 [57.8 s]    dev=(HR@5:0.5222,NDCG@5:0.3760) [0.1 s]
INFO:root:Epoch 34    loss=0.0848 [58.5 s]    dev=(HR@5:0.5254,NDCG@5:0.3787) [0.1 s]
INFO:root:Epoch 35    loss=0.0854 [56.9 s]    dev=(HR@5:0.5277,NDCG@5:0.3788) [0.1 s]
INFO:root:Epoch 36    loss=0.0824 [58.7 s]    dev=(HR@5:0.5250,NDCG@5:0.3809) [0.1 s]
INFO:root:Epoch 37    loss=0.0835 [57.7 s]    dev=(HR@5:0.5289,NDCG@5:0.3807) [0.1 s]
INFO:root:Epoch 38    loss=0.0826 [57.6 s]    dev=(HR@5:0.5316,NDCG@5:0.3814) [0.1 s]
INFO:root:Epoch 39    loss=0.0816 [59.0 s]    dev=(HR@5:0.5336,NDCG@5:0.3827) [0.1 s] *
INFO:root:Epoch 40    loss=0.0814 [59.0 s]    dev=(HR@5:0.5332,NDCG@5:0.3797) [0.1 s]
INFO:root:Epoch 41    loss=0.0799 [59.2 s]    dev=(HR@5:0.5297,NDCG@5:0.3793) [0.1 s]
INFO:root:Epoch 42    loss=0.0798 [58.1 s]    dev=(HR@5:0.5297,NDCG@5:0.3810) [0.1 s]
INFO:root:Epoch 43    loss=0.0789 [60.1 s]    dev=(HR@5:0.5347,NDCG@5:0.3841) [0.1 s] *
INFO:root:Epoch 44    loss=0.0794 [59.2 s]    dev=(HR@5:0.5304,NDCG@5:0.3812) [0.1 s]
INFO:root:Epoch 45    loss=0.0780 [58.2 s]    dev=(HR@5:0.5254,NDCG@5:0.3787) [0.1 s]
INFO:root:Epoch 46    loss=0.0775 [58.7 s]    dev=(HR@5:0.5277,NDCG@5:0.3790) [0.1 s]
INFO:root:Epoch 47    loss=0.0775 [59.8 s]    dev=(HR@5:0.5293,NDCG@5:0.3830) [0.1 s]
INFO:root:Epoch 48    loss=0.0763 [59.0 s]    dev=(HR@5:0.5242,NDCG@5:0.3793) [0.1 s]
INFO:root:Epoch 49    loss=0.0765 [60.1 s]    dev=(HR@5:0.5277,NDCG@5:0.3807) [0.1 s]
INFO:root:Epoch 50    loss=0.0763 [58.5 s]    dev=(HR@5:0.5289,NDCG@5:0.3790) [0.1 s]
INFO:root:Epoch 51    loss=0.0753 [58.9 s]    dev=(HR@5:0.5250,NDCG@5:0.3740) [0.1 s]
INFO:root:Epoch 52    loss=0.0747 [58.7 s]    dev=(HR@5:0.5172,NDCG@5:0.3733) [0.1 s]
INFO:root:Epoch 53    loss=0.0751 [58.1 s]    dev=(HR@5:0.5250,NDCG@5:0.3791) [0.1 s]
INFO:root:Epoch 54    loss=0.0745 [59.2 s]    dev=(HR@5:0.5222,NDCG@5:0.3750) [0.1 s]
INFO:root:Epoch 55    loss=0.0737 [59.7 s]    dev=(HR@5:0.5242,NDCG@5:0.3755) [0.1 s]
INFO:root:Epoch 56    loss=0.0744 [59.1 s]    dev=(HR@5:0.5293,NDCG@5:0.3823) [0.1 s]
INFO:root:Epoch 57    loss=0.0726 [58.8 s]    dev=(HR@5:0.5254,NDCG@5:0.3783) [0.1 s]
INFO:root:Epoch 58    loss=0.0726 [58.7 s]    dev=(HR@5:0.5340,NDCG@5:0.3804) [0.1 s]
INFO:root:Epoch 59    loss=0.0731 [59.3 s]    dev=(HR@5:0.5269,NDCG@5:0.3767) [0.1 s]
INFO:root:Epoch 60    loss=0.0721 [59.0 s]    dev=(HR@5:0.5277,NDCG@5:0.3794) [0.1 s]
INFO:root:Epoch 61    loss=0.0725 [58.9 s]    dev=(HR@5:0.5258,NDCG@5:0.3739) [0.1 s]
INFO:root:Epoch 62    loss=0.0720 [59.3 s]    dev=(HR@5:0.5226,NDCG@5:0.3755) [0.1 s]
INFO:root:Epoch 63    loss=0.0715 [59.8 s]    dev=(HR@5:0.5293,NDCG@5:0.3789) [0.1 s]
INFO:root:Early stop at 63 based on dev result.
INFO:root:
Best Iter(dev)=   43	 dev=(HR@5:0.5347,NDCG@5:0.3841) [3694.7 s] 
INFO:root:Load model from ../model/BSARec/BSARec__MovieLens_1M__0__lr=0.0001__l2=1e-06__emb_size=64__num_layers=2__num_heads=4.pt
INFO:root:
Test After Training: (HR@5:0.5303,NDCG@5:0.3971,HR@10:0.6768,NDCG@10:0.4447,HR@20:0.8215,NDCG@20:0.4816,HR@50:0.9656,NDCG@50:0.5103)
INFO:root:
--------------------------------------------- END: 2024-12-30 00:36:03 ---------------------------------------------
INFO:root:Namespace(model_name='BSARec')
INFO:root:--------------------------------------------- BEGIN: 2024-12-30 21:42:30 ---------------------------------------------
INFO:root:
=============================================
 Arguments                    | Values       
=============================================
 alpha                        | 0.3         
 attention_probs_dropout_prob | 0.1         
 batch_size                   | 256         
 c                            | 5           
 dataset                      | MovieLens_1M
 dropout                      | 0           
 early_stop                   | 10          
 emb_size                     | 64          
 epoch                        | 200         
 eval_batch_size              | 256         
 gpu                          | 0           
 hidden_dropout_prob          | 0.1         
 hidden_size                  | 64          
 history_max                  | 20          
 l2                           | 1e-06       
 lr                           | 0.0001      
 num_heads                    | 4           
 num_layers                   | 2           
 num_neg                      | 1           
 num_workers                  | 0           
 optimizer                    | Adam        
 random_seed                  | 0           
 test_all                     | 0           
 topk                         | 5,10,20,50  
=============================================
INFO:root:Device: cuda
INFO:root:Load corpus from ../data/MovieLens_1M/SeqReader.pkl
INFO:root:#params: 301760
INFO:root:BSARec(
  (i_embeddings): Embedding(3126, 64)
  (p_embeddings): Embedding(21, 64)
  (transformer_block): ModuleList(
    (0): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.3999 [58.1 s]    dev=(HR@5:0.3419,NDCG@5:0.2283) [0.1 s] *
INFO:root:Epoch 2     loss=0.2982 [55.4 s]    dev=(HR@5:0.3845,NDCG@5:0.2560) [0.1 s] *
INFO:root:Epoch 3     loss=0.2486 [57.4 s]    dev=(HR@5:0.4145,NDCG@5:0.2747) [0.1 s] *
INFO:root:Epoch 4     loss=0.2161 [56.1 s]    dev=(HR@5:0.4415,NDCG@5:0.3042) [0.1 s] *
INFO:root:Epoch 5     loss=0.1893 [56.9 s]    dev=(HR@5:0.4582,NDCG@5:0.3181) [0.1 s] *
INFO:root:Epoch 6     loss=0.1701 [56.5 s]    dev=(HR@5:0.4676,NDCG@5:0.3255) [0.1 s] *
INFO:root:Epoch 7     loss=0.1592 [55.2 s]    dev=(HR@5:0.4758,NDCG@5:0.3337) [0.1 s] *
INFO:root:Epoch 8     loss=0.1495 [57.5 s]    dev=(HR@5:0.4895,NDCG@5:0.3401) [0.1 s] *
INFO:root:Epoch 9     loss=0.1410 [58.3 s]    dev=(HR@5:0.4844,NDCG@5:0.3439) [0.1 s] *
INFO:root:Early stop manually
INFO:root:
--------------------------------------------- END: 2024-12-30 21:51:25 ---------------------------------------------
INFO:root:Namespace(model_name='BSARec')
INFO:root:--------------------------------------------- BEGIN: 2024-12-30 21:51:30 ---------------------------------------------
INFO:root:
=============================================
 Arguments                    | Values       
=============================================
 alpha                        | 0.3         
 attention_probs_dropout_prob | 0.1         
 batch_size                   | 256         
 c                            | 9           
 dataset                      | MovieLens_1M
 dropout                      | 0           
 early_stop                   | 10          
 emb_size                     | 64          
 epoch                        | 200         
 eval_batch_size              | 256         
 gpu                          | 0           
 hidden_dropout_prob          | 0.1         
 hidden_size                  | 64          
 history_max                  | 20          
 l2                           | 1e-06       
 lr                           | 0.0001      
 num_heads                    | 4           
 num_layers                   | 2           
 num_neg                      | 1           
 num_workers                  | 0           
 optimizer                    | Adam        
 random_seed                  | 0           
 test_all                     | 0           
 topk                         | 5,10,20,50  
=============================================
INFO:root:Device: cuda
INFO:root:Load corpus from ../data/MovieLens_1M/SeqReader.pkl
INFO:root:#params: 301760
INFO:root:BSARec(
  (i_embeddings): Embedding(3126, 64)
  (p_embeddings): Embedding(21, 64)
  (transformer_block): ModuleList(
    (0): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.3998 [60.0 s]    dev=(HR@5:0.3396,NDCG@5:0.2271) [0.1 s] *
INFO:root:Epoch 2     loss=0.2978 [57.2 s]    dev=(HR@5:0.3845,NDCG@5:0.2560) [0.1 s] *
INFO:root:Epoch 3     loss=0.2509 [57.9 s]    dev=(HR@5:0.4098,NDCG@5:0.2697) [0.1 s] *
INFO:root:Epoch 4     loss=0.2186 [56.4 s]    dev=(HR@5:0.4415,NDCG@5:0.3041) [0.1 s] *
INFO:root:Epoch 5     loss=0.1906 [57.2 s]    dev=(HR@5:0.4555,NDCG@5:0.3169) [0.1 s] *
INFO:root:Epoch 6     loss=0.1709 [57.5 s]    dev=(HR@5:0.4699,NDCG@5:0.3254) [0.1 s] *
INFO:root:Epoch 7     loss=0.1598 [57.8 s]    dev=(HR@5:0.4750,NDCG@5:0.3322) [0.1 s] *
INFO:root:Epoch 8     loss=0.1504 [57.5 s]    dev=(HR@5:0.4859,NDCG@5:0.3408) [0.1 s] *
INFO:root:Epoch 9     loss=0.1419 [56.9 s]    dev=(HR@5:0.4867,NDCG@5:0.3451) [0.1 s] *
INFO:root:Epoch 10    loss=0.1357 [58.5 s]    dev=(HR@5:0.4914,NDCG@5:0.3487) [0.1 s] *
INFO:root:Epoch 11    loss=0.1309 [57.4 s]    dev=(HR@5:0.4988,NDCG@5:0.3549) [0.1 s] *
INFO:root:Epoch 12    loss=0.1262 [57.9 s]    dev=(HR@5:0.5027,NDCG@5:0.3556) [0.1 s] *
INFO:root:Epoch 13    loss=0.1218 [56.7 s]    dev=(HR@5:0.5121,NDCG@5:0.3652) [0.1 s] *
INFO:root:Epoch 14    loss=0.1180 [57.7 s]    dev=(HR@5:0.5180,NDCG@5:0.3656) [0.1 s] *
INFO:root:Epoch 15    loss=0.1152 [57.5 s]    dev=(HR@5:0.5215,NDCG@5:0.3724) [0.1 s] *
INFO:root:Epoch 16    loss=0.1115 [57.7 s]    dev=(HR@5:0.5133,NDCG@5:0.3702) [0.1 s]
INFO:root:Epoch 17    loss=0.1099 [56.5 s]    dev=(HR@5:0.5226,NDCG@5:0.3761) [0.1 s] *
INFO:root:Epoch 18    loss=0.1072 [57.0 s]    dev=(HR@5:0.5172,NDCG@5:0.3735) [0.1 s]
INFO:root:Epoch 19    loss=0.1047 [58.6 s]    dev=(HR@5:0.5133,NDCG@5:0.3724) [0.1 s]
INFO:root:Epoch 20    loss=0.1034 [58.3 s]    dev=(HR@5:0.5195,NDCG@5:0.3757) [0.1 s]
INFO:root:Epoch 21    loss=0.1023 [56.4 s]    dev=(HR@5:0.5152,NDCG@5:0.3730) [0.1 s]
INFO:root:Epoch 22    loss=0.1000 [57.3 s]    dev=(HR@5:0.5191,NDCG@5:0.3753) [0.1 s]
INFO:root:Epoch 23    loss=0.0985 [57.0 s]    dev=(HR@5:0.5156,NDCG@5:0.3745) [0.1 s]
INFO:root:Epoch 24    loss=0.0968 [57.4 s]    dev=(HR@5:0.5211,NDCG@5:0.3781) [0.1 s] *
INFO:root:Epoch 25    loss=0.0955 [57.7 s]    dev=(HR@5:0.5238,NDCG@5:0.3788) [0.1 s] *
INFO:root:Epoch 26    loss=0.0943 [57.7 s]    dev=(HR@5:0.5164,NDCG@5:0.3723) [0.1 s]
INFO:root:Epoch 27    loss=0.0930 [57.5 s]    dev=(HR@5:0.5191,NDCG@5:0.3761) [0.1 s]
INFO:root:Epoch 28    loss=0.0922 [58.1 s]    dev=(HR@5:0.5152,NDCG@5:0.3698) [0.1 s]
INFO:root:Epoch 29    loss=0.0912 [57.7 s]    dev=(HR@5:0.5183,NDCG@5:0.3732) [0.1 s]
INFO:root:Epoch 30    loss=0.0906 [57.2 s]    dev=(HR@5:0.5207,NDCG@5:0.3735) [0.1 s]
INFO:root:Epoch 31    loss=0.0896 [58.0 s]    dev=(HR@5:0.5152,NDCG@5:0.3710) [0.1 s]
INFO:root:Epoch 32    loss=0.0882 [56.4 s]    dev=(HR@5:0.5121,NDCG@5:0.3701) [0.1 s]
INFO:root:Epoch 33    loss=0.0869 [58.7 s]    dev=(HR@5:0.5125,NDCG@5:0.3690) [0.1 s]
INFO:root:Epoch 34    loss=0.0865 [58.9 s]    dev=(HR@5:0.5121,NDCG@5:0.3705) [0.1 s]
INFO:root:Epoch 35    loss=0.0867 [59.1 s]    dev=(HR@5:0.5148,NDCG@5:0.3745) [0.1 s]
INFO:root:Epoch 36    loss=0.0839 [57.3 s]    dev=(HR@5:0.5117,NDCG@5:0.3694) [0.1 s]
INFO:root:Epoch 37    loss=0.0850 [57.4 s]    dev=(HR@5:0.5176,NDCG@5:0.3727) [0.1 s]
INFO:root:Epoch 38    loss=0.0843 [57.3 s]    dev=(HR@5:0.5180,NDCG@5:0.3712) [0.1 s]
INFO:root:Epoch 39    loss=0.0831 [58.3 s]    dev=(HR@5:0.5105,NDCG@5:0.3689) [0.1 s]
INFO:root:Epoch 40    loss=0.0829 [56.7 s]    dev=(HR@5:0.5187,NDCG@5:0.3724) [0.1 s]
INFO:root:Epoch 41    loss=0.0816 [57.0 s]    dev=(HR@5:0.5117,NDCG@5:0.3702) [0.1 s]
INFO:root:Epoch 42    loss=0.0813 [57.7 s]    dev=(HR@5:0.5176,NDCG@5:0.3710) [0.1 s]
INFO:root:Epoch 43    loss=0.0804 [56.2 s]    dev=(HR@5:0.5176,NDCG@5:0.3744) [0.1 s]
INFO:root:Early stop manually
INFO:root:
--------------------------------------------- END: 2024-12-30 22:33:12 ---------------------------------------------
INFO:root:Namespace(model_name='BSARec')
INFO:root:--------------------------------------------- BEGIN: 2024-12-30 22:33:18 ---------------------------------------------
INFO:root:
=============================================
 Arguments                    | Values       
=============================================
 alpha                        | 0.3         
 attention_probs_dropout_prob | 0.1         
 batch_size                   | 256         
 c                            | 5           
 dataset                      | MovieLens_1M
 dropout                      | 0           
 early_stop                   | 10          
 emb_size                     | 64          
 epoch                        | 200         
 eval_batch_size              | 256         
 gpu                          | 0           
 hidden_dropout_prob          | 0.1         
 hidden_size                  | 64          
 history_max                  | 20          
 l2                           | 1e-06       
 lr                           | 0.0001      
 num_heads                    | 4           
 num_layers                   | 2           
 num_neg                      | 1           
 num_workers                  | 0           
 optimizer                    | Adam        
 random_seed                  | 0           
 test_all                     | 0           
 topk                         | 5,10,20,50  
=============================================
INFO:root:Device: cuda
INFO:root:Load corpus from ../data/MovieLens_1M/SeqReader.pkl
INFO:root:#params: 301760
INFO:root:BSARec(
  (i_embeddings): Embedding(3126, 64)
  (p_embeddings): Embedding(21, 64)
  (transformer_block): ModuleList(
    (0): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): BSARecBlock(
      (layer): BSARecLayer(
        (filter_layer): FrequencyLayer(
          (out_dropout): Dropout(p=0, inplace=False)
          (LayerNorm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attention_layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (feed_forward): FeedForward(
        (dense_1): Linear(in_features=64, out_features=256, bias=True)
        (dense_2): Linear(in_features=256, out_features=64, bias=True)
        (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.3999 [58.9 s]    dev=(HR@5:0.3419,NDCG@5:0.2283) [0.1 s] *
INFO:root:Epoch 2     loss=0.2982 [56.6 s]    dev=(HR@5:0.3845,NDCG@5:0.2560) [0.1 s] *
INFO:root:Epoch 3     loss=0.2486 [57.0 s]    dev=(HR@5:0.4145,NDCG@5:0.2747) [0.1 s] *
INFO:root:Epoch 4     loss=0.2161 [55.8 s]    dev=(HR@5:0.4415,NDCG@5:0.3042) [0.1 s] *
INFO:root:Epoch 5     loss=0.1893 [56.7 s]    dev=(HR@5:0.4582,NDCG@5:0.3181) [0.1 s] *
INFO:root:Epoch 6     loss=0.1701 [57.2 s]    dev=(HR@5:0.4676,NDCG@5:0.3255) [0.1 s] *
INFO:root:Epoch 7     loss=0.1592 [57.0 s]    dev=(HR@5:0.4758,NDCG@5:0.3337) [0.1 s] *
INFO:root:Epoch 8     loss=0.1495 [56.0 s]    dev=(HR@5:0.4895,NDCG@5:0.3401) [0.1 s] *
INFO:root:Epoch 9     loss=0.1410 [57.6 s]    dev=(HR@5:0.4844,NDCG@5:0.3439) [0.1 s] *
INFO:root:Epoch 10    loss=0.1346 [56.9 s]    dev=(HR@5:0.4953,NDCG@5:0.3491) [0.1 s] *
INFO:root:Epoch 11    loss=0.1298 [56.8 s]    dev=(HR@5:0.5035,NDCG@5:0.3539) [0.1 s] *
INFO:root:Epoch 12    loss=0.1251 [58.2 s]    dev=(HR@5:0.5020,NDCG@5:0.3561) [0.1 s] *
INFO:root:Epoch 13    loss=0.1210 [56.2 s]    dev=(HR@5:0.5125,NDCG@5:0.3619) [0.1 s] *
INFO:root:Epoch 14    loss=0.1170 [57.7 s]    dev=(HR@5:0.5180,NDCG@5:0.3678) [0.1 s] *
INFO:root:Epoch 15    loss=0.1143 [55.2 s]    dev=(HR@5:0.5203,NDCG@5:0.3682) [0.1 s] *
INFO:root:Epoch 16    loss=0.1109 [57.0 s]    dev=(HR@5:0.5172,NDCG@5:0.3707) [0.1 s] *
INFO:root:Epoch 17    loss=0.1090 [55.6 s]    dev=(HR@5:0.5203,NDCG@5:0.3748) [0.1 s] *
INFO:root:Epoch 18    loss=0.1066 [55.7 s]    dev=(HR@5:0.5207,NDCG@5:0.3737) [0.0 s]
INFO:root:Epoch 19    loss=0.1039 [56.8 s]    dev=(HR@5:0.5222,NDCG@5:0.3763) [0.0 s] *
INFO:root:Epoch 20    loss=0.1026 [56.9 s]    dev=(HR@5:0.5191,NDCG@5:0.3771) [0.1 s] *
INFO:root:Epoch 21    loss=0.1016 [54.5 s]    dev=(HR@5:0.5156,NDCG@5:0.3753) [0.1 s]
INFO:root:Epoch 22    loss=0.0994 [57.0 s]    dev=(HR@5:0.5125,NDCG@5:0.3725) [0.1 s]
INFO:root:Epoch 23    loss=0.0979 [56.7 s]    dev=(HR@5:0.5160,NDCG@5:0.3758) [0.0 s]
INFO:root:Epoch 24    loss=0.0960 [56.1 s]    dev=(HR@5:0.5199,NDCG@5:0.3781) [0.1 s] *
INFO:root:Epoch 25    loss=0.0951 [56.6 s]    dev=(HR@5:0.5234,NDCG@5:0.3776) [0.1 s]
INFO:root:Epoch 26    loss=0.0935 [55.5 s]    dev=(HR@5:0.5203,NDCG@5:0.3747) [0.1 s]
INFO:root:Epoch 27    loss=0.0923 [56.0 s]    dev=(HR@5:0.5242,NDCG@5:0.3746) [0.1 s]
INFO:root:Epoch 28    loss=0.0915 [58.1 s]    dev=(HR@5:0.5219,NDCG@5:0.3735) [0.1 s]
INFO:root:Epoch 29    loss=0.0904 [57.6 s]    dev=(HR@5:0.5195,NDCG@5:0.3738) [0.1 s]
INFO:root:Epoch 30    loss=0.0897 [55.7 s]    dev=(HR@5:0.5347,NDCG@5:0.3777) [0.1 s]
INFO:root:Epoch 31    loss=0.0889 [56.7 s]    dev=(HR@5:0.5258,NDCG@5:0.3764) [0.1 s]
INFO:root:Epoch 32    loss=0.0873 [55.4 s]    dev=(HR@5:0.5199,NDCG@5:0.3731) [0.1 s]
INFO:root:Epoch 33    loss=0.0863 [57.0 s]    dev=(HR@5:0.5176,NDCG@5:0.3703) [0.1 s]
INFO:root:Epoch 34    loss=0.0856 [56.3 s]    dev=(HR@5:0.5199,NDCG@5:0.3741) [0.1 s]
INFO:root:Epoch 35    loss=0.0858 [55.9 s]    dev=(HR@5:0.5195,NDCG@5:0.3741) [0.1 s]
INFO:root:Epoch 36    loss=0.0831 [57.1 s]    dev=(HR@5:0.5211,NDCG@5:0.3718) [0.1 s]
INFO:root:Epoch 37    loss=0.0839 [57.7 s]    dev=(HR@5:0.5234,NDCG@5:0.3745) [0.1 s]
INFO:root:Epoch 38    loss=0.0834 [58.6 s]    dev=(HR@5:0.5273,NDCG@5:0.3765) [0.1 s]
INFO:root:Epoch 39    loss=0.0822 [54.8 s]    dev=(HR@5:0.5234,NDCG@5:0.3735) [0.1 s]
INFO:root:Epoch 40    loss=0.0821 [57.4 s]    dev=(HR@5:0.5285,NDCG@5:0.3760) [0.1 s]
INFO:root:Epoch 41    loss=0.0808 [55.5 s]    dev=(HR@5:0.5164,NDCG@5:0.3746) [0.1 s]
INFO:root:Epoch 42    loss=0.0804 [55.4 s]    dev=(HR@5:0.5222,NDCG@5:0.3737) [0.1 s]
INFO:root:Epoch 43    loss=0.0795 [56.7 s]    dev=(HR@5:0.5199,NDCG@5:0.3727) [0.1 s]
INFO:root:Epoch 44    loss=0.0801 [56.6 s]    dev=(HR@5:0.5180,NDCG@5:0.3721) [0.1 s]
INFO:root:Early stop at 44 based on dev result.
INFO:root:
Best Iter(dev)=   24	 dev=(HR@5:0.5199,NDCG@5:0.3781) [2493.7 s] 
INFO:root:Load model from ../model/BSARec/BSARec__MovieLens_1M__0__lr=0.0001__l2=1e-06__emb_size=64__num_layers=2__num_heads=4.pt
INFO:root:
Test After Training: (HR@5:0.5358,NDCG@5:0.3970,HR@10:0.6681,NDCG@10:0.4395,HR@20:0.8083,NDCG@20:0.4751,HR@50:0.9617,NDCG@50:0.5060)
INFO:root:
--------------------------------------------- END: 2024-12-30 23:14:54 ---------------------------------------------
